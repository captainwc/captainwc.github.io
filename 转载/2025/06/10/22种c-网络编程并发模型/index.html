<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>C&#43;&#43; é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç° | [è½¬è½½](https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md) | SHUAIKAI&#39;s Blog</title>
    <link rel="icon" href= /images/favicon.png />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />

    <link rel="stylesheet" href="/css/custom.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">ä¸»é¡µ</a></li>
      
      <li><a href="/series/">ä¸“æ </a></li>
      
      <li><a href="/categories/">åˆ†ç±»</a></li>
      
      <li><a href="/tags/">æ ‡ç­¾</a></li>
      
      <li><a href="/archives/">å½’æ¡£</a></li>
      
      <li><a href="/search/">æœç´¢</a></li>
      
      <li><a href="/about/">å…³äº</a></li>
      
    </ul>
    <hr/>
    </nav>


<div class="article-meta">
    <h1><span class="article-meta-title">C++ é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç° | 
<a href="https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md"  target="_blank" rel="noopener noreferrer" >è½¬è½½</a></span></h1>

    <div class="article-meta-info">
        

        
        
        
        

        
        
        
        

        
        

        
        
        
        
        
        
        
        
        

        
        
        
        
        
        
        
        
        
        
        
        

        ğŸ•ºğŸ» å‘¨æœ«ç¨‹åºçŒ¿ ğŸ—“ï¸ 2025-06-10 ğŸ—‚ï¸ <a href="/categories/%E5%8D%9A%E5%AE%A2%E5%89%AA%E8%97%8F/">åšå®¢å‰ªè—</a> ğŸ·ï¸ <a href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">#ç½‘ç»œç¼–ç¨‹</a> <a href="/tags/c++/">#C++</a>
    </div>
</div>

<main>

    

<div class="left-sidebar-btn" id="leftSidebarBtn"><i class="fa-solid fa-list"></i></div>
<div class="left-sidebar-panel" id="leftSidebarPanel">
    
        <div class="sidebar-content">
            
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">ğŸ·ï¸ æ ‡ç­¾</div>
                <div class="tag-blocks">
                    
                    <a href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B" class="tag-block">
                        ç½‘ç»œç¼–ç¨‹
                    </a>
                    
                    <a href="/tags/c&#43;&#43;" class="tag-block">
                        C&#43;&#43;
                    </a>
                    
                </div>
            </div>
            

            
            

            
            
            
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">ğŸ—‚ï¸ åˆ†ç±»æ–‡ç« </div>
                
                
                <div class="category-group">
                    <div class="category-name">åšå®¢å‰ªè—</div>
                    <ul class="article-list">
                        
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/05/04/epoll%E8%AF%A6%E8%A7%A3/" class="article-link">
                                
                                <span class="article-title">Epollè¯¦ç»†ä»‹ç» | [è½¬è½½](https://mp.weixin.qq.com/s/pahk8ay5MvkvONeg1-M82w)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/05/04/%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/" class="article-link">
                                
                                <span class="article-title">å…±äº«å†…å­˜è¯¦è§£ | [è½¬è½½](https://mp.weixin.qq.com/s/wOySn0oi0xXREpFRBXCMmQ)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/04/17/asio-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E4%B8%8E%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/" class="article-link">
                                
                                <span class="article-title">Asio åŸºæœ¬ä½¿ç”¨ä¸æ ¸å¿ƒè®¾è®¡æ€æƒ³ | [è½¬è½½](https://blog.csdn.net/gma999/article/details/143983035)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/04/16/googletest%E4%B8%8Egmock%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/" class="article-link">
                                
                                <span class="article-title">GoogleTestä¸gMockè¿›é˜¶æŒ‡å— | [è½¬è½½](https://www.cnblogs.com/jinyunshaobing/p/16804309.html)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/04/16/gtest_gmock-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/" class="article-link">
                                
                                <span class="article-title">GTest / GMock å•å…ƒæµ‹è¯•å®è·µæ‰‹å†Œ | [è½¬è½½](https://imageslr.com/2023/gtest.html)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/04/15/docker-%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3%E5%8F%8A%E5%AE%B9%E5%99%A8%E9%97%B4%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/" class="article-link">
                                
                                <span class="article-title">Docker ç½‘ç»œæ¨¡å¼è¯¦è§£åŠå®¹å™¨é—´ç½‘ç»œé€šä¿¡ | [è½¬è½½](https://www.cnblogs.com/mrhelloworld/p/docker11.html)</span>
                            </a>
                        </li>
                        
                        
                        
                        <li class="article-item">
                            <a href="/%E8%BD%AC%E8%BD%BD/2025/04/15/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AE%80%E8%BF%B0apollo%E4%B8%ADcyberrt%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" class="article-link">
                                
                                <span class="article-title">ä¸‡å­—é•¿æ–‡ç®€è¿°Apolloä¸­CyberRTæ¡†æ¶åŸºç¡€æ¦‚å¿µ | [è½¬è½½](https://zhuanlan.zhihu.com/p/479518561#CTZ_DEFAULT)</span>
                            </a>
                        </li>
                        
                        
                    </ul>
                </div>
                
            </div>
            
        </div>
    </div>

    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('leftSidebarBtn');
            const panel = document.getElementById('leftSidebarPanel');
            let hoverTimeout;

            
            btn.addEventListener('mouseenter', () => {
                clearTimeout(hoverTimeout);
                panel.classList.add('show');
            });

            panel.addEventListener('mouseenter', () => clearTimeout(hoverTimeout));

            [btn, panel].forEach(el => {
                el.addEventListener('mouseleave', () => {
                    hoverTimeout = setTimeout(() => {
                        panel.classList.remove('show');
                    }, 200);
                });
            });
        });
    </script>
    

    <style>
        

         
        .left-sidebar-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 980;
            cursor: pointer;
            padding: 6px 10px;
            background: #EFEFEF;
            border-radius: 8px;
            transition: background 0.3s;
            color: #999;
            opacity: 0.7;
        }

        .left-sidebar-btn:hover {
            background: #BEC2B3;
        }

        .left-sidebar-panel {
            border-radius: 8px;
            display: none;
            position: fixed;
            top: 66px;
            left: 20px;
            max-width: 360px;
            min-width: 280px;
            max-height: 80vh;
            overflow-y: auto;
            background: white;
            border: 1px solid #eee;
            padding: 10px 5px 10px 15px;
            z-index: 970;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .left-sidebar-panel.show {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        

        .sidebar-content {
            padding: 15px 12px;
        }

        .sidebar-section {
            margin-bottom: 1.2rem;
        }

        .sidebar-section-title {
            font-size: 1rem;
            color: #2d3842;
            margin: 0 0 0.6rem 0;
            padding-bottom: 0.3rem;
            font-family: "LXGW WenKai";
            font-weight: bold;

             
            
            border-bottom: 2px dashed #cfcfcf;
            
        }

         
        .tag-blocks {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .tag-block {
            display: inline-block;
            background: #F6F6F6;
            color: #666;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }

        .tag-block:hover {
            background: #2e59a7;
            color: white;
            transform: translateY(-1px);
        }

         
        .series-group,
        .category-group {
            margin-bottom: 0.8rem;
        }

        .series-name,
        .category-name {
            font-size: 0.9rem;
            color: #666;
            margin: 0 0 0.4rem 0;
            font-weight: bold;
            font-family: "LXGW WenKai";
        }

         
        .article-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .article-item {
            margin-bottom: 0.3rem;
        }

        .article-link {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.25rem 0.4rem;
            border-radius: 4px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .article-link:hover {
            background: #f8f9fa;
            border-left-color: #2e59a7;
            transform: translateX(3px);
        }

        .article-date {
            font-size: 0.8rem;
            color: #999;
            font-family: "LXGW WenKai";
            flex-shrink: 0;
            width: 45px;
            text-align: left;
        }

        .article-title {
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

         
        

        .left-sidebar-panel::-webkit-scrollbar {
            display: none;
        }

        .left-sidebar-panel {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        

         
        @media (max-width: 768px) {
        
        }
    </style>

    


<div class="toc-btn" id="tocBtn"><i class="fa-solid fa-bars-staggered"></i></div>
<div class="toc-panel" id="tocPanel"></div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        
        const btn = document.getElementById('tocBtn');
        const panel = document.getElementById('tocPanel');
        let hoverTimeout;

        
        btn.addEventListener('mouseenter', () => {
            clearTimeout(hoverTimeout);
            generateToc(panel);
            panel.classList.add('show');

            
            requestAnimationFrame(() => {
                const headers = Array.from(document.querySelectorAll('h2, h3, h4, h5, h6'));
                let activeHeader = null;
                let minDistance = Infinity;

                
                headers.forEach(header => {
                    const rect = header.getBoundingClientRect();
                    const distance = Math.abs(rect.top);
                    if (distance < minDistance) {
                        minDistance = distance;
                        activeHeader = header;
                    }
                });

                
                if (activeHeader) {
                    const activeLink = panel.querySelector(`a[href="#${activeHeader.id}"]`);
                    if (activeLink) {
                        
                        const panelHeight = panel.offsetHeight;
                        const linkOffset = activeLink.offsetTop;
                        const centerPosition = linkOffset - (panelHeight / 2) + (activeLink.offsetHeight / 2);
                        
                        panel.scrollTo({
                            top: centerPosition,
                            behavior: 'auto'
                        });
                    }
                }
            });
        });

        panel.addEventListener('mouseenter', () => clearTimeout(hoverTimeout));

        [btn, panel].forEach(el => {
            el.addEventListener('mouseleave', () => {
                hoverTimeout = setTimeout(() => {
                    panel.classList.remove('show');
                }, 200);
            });
        });
        

        
        function generateToc(container) {
            if (container.children.length > 0) return;

            const headers = Array.from(document.querySelectorAll('h2, h3, h4, h5, h6'));
            const counts = [0, 0, 0, 0, 0]; 

            headers.forEach(header => {
                const level = parseInt(header.tagName[1]) - 2;
                if (level < 0) return;

                counts[level]++;
                for (let i = level + 1; i < counts.length; i++) counts[i] = 0;
                const number = counts.slice(0, level + 1).join('.');

                
                const numberSpan = document.createElement('span');
                numberSpan.className = 'toc-number';
                numberSpan.textContent = number;

                
                const link = document.createElement('a');
                link.href = `#${header.id}`;
                link.style.paddingLeft = `${level * 12}px`;

                
                link.appendChild(numberSpan);
                link.appendChild(document.createTextNode(header.textContent));

                container.appendChild(link);
            });
        }
    });
</script>

<style>
    

     
    .toc-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 980;
        cursor: pointer;
        padding: 6px 10px;
        background: #EFEFEF;
        border-radius: 8px;
        transition: background 0.3s;
        color: #999;
        opacity: 0.7;
    }

    .toc-btn:hover {
        background: #BEC2B3;
    }

    .toc-panel {
        border-radius: 8px;
        display: none;
        position: fixed;
        top: 66px;
        right: 20px;
        max-width: 360px;
        min-width: 200px;
        max-height: 80vh;
        overflow-y: auto;
        background: white;
        border: 1px solid #eee;
        padding: 10px 5px 10px 15px;
        z-index: 970;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        list-style: none;
    }

    .toc-panel.show {
        display: block;
        animation: fadeIn 0.3s ease-out;
    }

     
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateX(10px);
        }

        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    

     
    .toc-number {
        vertical-align: middle;
        margin-right: 6px;
        font-family: "LXGW WenKai";
        font-size: 0.85rem;
    }

     
        

    .toc-panel a {
        
            display: block;
            padding: 4px 0;
            text-decoration: none;
            color: #333;
            white-space: nowrap;
        }

        

        .toc-panel a:hover {
        

                color: #007bff;
            }

        
</style>


    
    
    
        <h1 id="c-é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç°">C++ é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç°</h1>

          <link rel="stylesheet" href="/css/vendors/admonitions.e8f9d71468684b38dcc32a3631441f47b6ee45ce52f3bcc31201e76cc2b0a193.css" integrity="sha256-6PnXFGhoSzjcwyo2MUQfR7buRc5S87zDEgHnbMKwoZM=" crossorigin="anonymous">
  <div class="admonition warning">
    <div class="admonition-header">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg>
      <span>å£°æ˜</span>
    </div>
      <div class="admonition-content">
        <ul>
<li>æœ¬æ–‡ç”±æ’ä»¶
<a href="https://chromewebstore.google.com/detail/markdownload-markdown-web/pcmpcfapbekmbjjkdalcgopdkipoggdi?pli=1"  target="_blank" rel="noopener noreferrer" >Markdown Web Clipper</a>
è‡ªåŠ¨æå–ç½‘é¡µæ­£æ–‡è€Œæ¥ï¼Œå¹¶æœªè·å–åŸä½œè€…æˆæƒï¼</li>
<li>æœ¬æ–‡ä»…ä½œä¸ªäººå­˜æ¡£å­¦ä¹ ä½¿ç”¨ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®/éœ€æ±‚è¯·æŸ¥çœ‹
<a href="https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md"  target="_blank" rel="noopener noreferrer" >åŸæ–‡</a>
ï¼</li>
<li>å¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»æœ¬äººç«‹åˆ»åˆ é™¤ï¼</li>
<li>åŸæ–‡é“¾æ¥: 
<a href="https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md"  target="_blank" rel="noopener noreferrer" >C++ é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç°</a>
</li>
</ul>
      </div>
  </div>
<hr>
<p>æœ¬é¡¹ç›®å®ç°äº†å¤šç§ä¸åŒçš„åç«¯æœåŠ¡å™¨å¹¶å‘æ¨¡å‹ï¼Œå±•ç¤ºäº†å„ç§ç½‘ç»œç¼–ç¨‹å’Œå¹¶å‘å¤„ç†æŠ€æœ¯ã€‚æ‰€æœ‰å®ç°éƒ½ä½¿ç”¨ C++11 æ ‡å‡†ï¼Œä¸ä¾èµ–ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<h2 id="é¡¹ç›®ç»“æ„">é¡¹ç›®ç»“æ„</h2>
<pre><code>concurrency_server/
â”œâ”€â”€ base/                           # åŸºç¡€ç»„ä»¶ç›®å½•
â”‚   â””â”€â”€ server_base.h              # æœåŠ¡å™¨åŸºç±»ï¼Œæä¾›é€šç”¨çš„socketæ“ä½œ
â”œâ”€â”€ benchmark/                      # æ€§èƒ½æµ‹è¯•å·¥å…·ç›®å½•
â”œâ”€â”€ main.cpp                        # ä¸»ç¨‹åºå…¥å£ï¼Œæ”¯æŒå¤šç§æœåŠ¡å™¨æ¨¡å‹åˆ‡æ¢
â”œâ”€â”€ Makefile                        # ç¼–è¯‘é…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”‚
â”œâ”€â”€ åŸºç¡€å¹¶å‘æ¨¡å‹
â”œâ”€â”€ single_process_server.h         # å•è¿›ç¨‹æ¨¡å‹ - ä¸²è¡Œå¤„ç†ï¼Œé€‚åˆå­¦ä¹ 
â”œâ”€â”€ multi_thread_server.h           # å¤šçº¿ç¨‹æ¨¡å‹ - æ¯è¿æ¥ä¸€çº¿ç¨‹
â”œâ”€â”€ multi_process_server.h          # å¤šè¿›ç¨‹æ¨¡å‹ - æ¯è¿æ¥ä¸€è¿›ç¨‹
â”œâ”€â”€ thread_pool_server.h            # çº¿ç¨‹æ± æ¨¡å‹ - å›ºå®šæ•°é‡å·¥ä½œçº¿ç¨‹
â”œâ”€â”€ process_pool1_server.h          # è¿›ç¨‹æ± æ¨¡å‹1 - é¢„åˆ›å»ºè¿›ç¨‹æ± 
â”œâ”€â”€ process_pool2_server.h          # è¿›ç¨‹æ± æ¨¡å‹2 - æ”¹è¿›çš„è¿›ç¨‹æ± å®ç°
â”‚
â”œâ”€â”€ I/Oå¤šè·¯å¤ç”¨æ¨¡å‹
â”œâ”€â”€ select_server.h                 # Selectæ¨¡å‹ - è·¨å¹³å°I/Oå¤šè·¯å¤ç”¨
â”œâ”€â”€ poll_server.h                   # Pollæ¨¡å‹ - æ”¹è¿›çš„selectå®ç°
â”œâ”€â”€ epoll_server.h                  # Epollæ¨¡å‹ - Linuxé«˜æ€§èƒ½I/Oå¤ç”¨
â”œâ”€â”€ kqueue_server.h                 # Kqueueæ¨¡å‹ - BSD/macOSé«˜æ€§èƒ½I/Oå¤ç”¨
â”‚
â”œâ”€â”€ é«˜çº§å¹¶å‘æ¶æ„
â”œâ”€â”€ reactor_server.h                # Reactoræ¨¡å¼ - äº‹ä»¶é©±åŠ¨æ¶æ„
â”œâ”€â”€ proactor_server.h               # Proactoræ¨¡å¼ - å¼‚æ­¥I/Oæ¶æ„
â”œâ”€â”€ event_loop_server.h             # äº‹ä»¶å¾ªç¯æ¨¡å‹ - å•çº¿ç¨‹äº‹ä»¶é©±åŠ¨
â”œâ”€â”€ half_sync_async_server.h        # åŠåŒæ­¥åŠå¼‚æ­¥æ¨¡å¼ - åˆ†å±‚å¤„ç†
â”œâ”€â”€ leader_follower_server.h        # Leader-Followeræ¨¡å¼ - åŠ¨æ€è§’è‰²åˆ‡æ¢
â”œâ”€â”€ producer_consumer_server.h      # ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ - è§£è€¦å¤„ç†
â”œâ”€â”€ pipeline_server.h               # ç®¡é“æ¨¡å¼ - æµæ°´çº¿å¤„ç†
â”œâ”€â”€ work_stealing_server.h          # å·¥ä½œçªƒå–æ¨¡å¼ - è´Ÿè½½å‡è¡¡
â”œâ”€â”€ hybrid_server.h                 # æ··åˆæ¨¡å¼ - å¤šç§æŠ€æœ¯ç»“åˆ
â”‚
â”œâ”€â”€ ç°ä»£å¹¶å‘æŠ€æœ¯
â”œâ”€â”€ coroutine_server.h              # åç¨‹æ¨¡å‹ - ç”¨æˆ·æ€è½»é‡çº§çº¿ç¨‹
â”œâ”€â”€ fiber_server.h                  # çº¤ç¨‹æ¨¡å‹ - åä½œå¼å¤šä»»åŠ¡
â”œâ”€â”€ actor_server.h                  # Actoræ¨¡å‹ - æ¶ˆæ¯ä¼ é€’å¹¶å‘
</code></pre>
<h2 id="æ”¯æŒçš„å¹¶å‘æ¨¡å‹">æ”¯æŒçš„å¹¶å‘æ¨¡å‹</h2>
<h3 id="1-singleprocess-å•è¿›ç¨‹æ¨¡å‹">1. SingleProcess (å•è¿›ç¨‹æ¨¡å‹)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>single_process_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä¸²è¡Œå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç®€å•ä½†æ€§èƒ½æœ‰é™</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: å­¦ä¹ å’Œè°ƒè¯•ï¼Œä½å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: å®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—å°‘</li>
<li><strong>ç¼ºç‚¹</strong>: æ— æ³•åˆ©ç”¨å¤šæ ¸ï¼Œä¸€ä¸ªè¯·æ±‚é˜»å¡ä¼šå½±å“æ‰€æœ‰åç»­è¯·æ±‚</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
å•è¿›ç¨‹æ¨¡å‹æ˜¯æœ€ç®€å•çš„æœåŠ¡å™¨æ¶æ„ï¼Œé‡‡ç”¨ä¼ ç»Ÿçš„é˜»å¡I/Oæ–¹å¼å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚<br>
æœåŠ¡å™¨åœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªä¸»å¾ªç¯æ¥ä¾æ¬¡å¤„ç†æ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥ã€‚<br>
å½“æœ‰æ–°è¿æ¥åˆ°è¾¾æ—¶ï¼ŒæœåŠ¡å™¨è°ƒç”¨accept()æ¥å—è¿æ¥ï¼Œç„¶ååŒæ­¥è¯»å–å®¢æˆ·ç«¯æ•°æ®ã€å¤„ç†è¯·æ±‚å¹¶å‘é€å“åº”ã€‚æ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ ¸å¿ƒå®ç°åŸºäºä¼ ç»Ÿçš„socketç¼–ç¨‹æ¨¡å¼ã€‚</li>
<li>æœåŠ¡å™¨åˆ›å»ºç›‘å¬socketå¹¶ç»‘å®šåˆ°æŒ‡å®šç«¯å£ï¼Œç„¶åè¿›å…¥æ— é™å¾ªç¯ç­‰å¾…è¿æ¥ã€‚</li>
<li>æ¯å½“accept()è¿”å›æ–°çš„å®¢æˆ·ç«¯socketæ—¶ï¼ŒæœåŠ¡å™¨ç«‹å³å¤„ç†è¯¥è¿æ¥çš„æ‰€æœ‰I/Oæ“ä½œï¼ŒåŒ…æ‹¬è¯»å–HTTPè¯·æ±‚ã€è§£æåè®®ã€ç”Ÿæˆå“åº”å¹¶å‘é€æ•°æ®ã€‚</li>
<li>ç”±äºé‡‡ç”¨é˜»å¡I/Oï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šç­‰å¾…å®Œæˆåæ‰ç»§ç»­ä¸‹ä¸€æ­¥ã€‚</li>
</ul>
<pre><code class="language-mermaid">sequenceDiagram
    participant C1 as Client1
    participant C2 as Client2
    participant S as Server Process
    
    C1-&gt;&gt;S: Connect
    S-&gt;&gt;S: Accept &amp; Process Request
    S-&gt;&gt;C1: Response
    Note over S: ä¸²è¡Œå¤„ç†ï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚
    C2-&gt;&gt;S: Connect (ç­‰å¾…)
    S-&gt;&gt;S: Accept &amp; Process Request
    S-&gt;&gt;C2: Response
</code></pre>
<h3 id="2-multiprocess-å¤šè¿›ç¨‹æ¨¡å‹">2. MultiProcess (å¤šè¿›ç¨‹æ¨¡å‹)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>multi_process_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ›å»ºç‹¬ç«‹è¿›ç¨‹</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦è¿›ç¨‹éš”ç¦»çš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: è¿›ç¨‹éš”ç¦»ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–</li>
<li><strong>ç¼ºç‚¹</strong>: è¿›ç¨‹åˆ›å»ºå¼€é”€å¤§ï¼Œå†…å­˜æ¶ˆè€—é«˜</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
å¤šè¿›ç¨‹æ¨¡å‹é€šè¿‡ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ›å»ºç‹¬ç«‹çš„å­è¿›ç¨‹æ¥å®ç°å¹¶å‘å¤„ç†ã€‚<br>
ä¸»è¿›ç¨‹è´Ÿè´£ç›‘å¬æ–°è¿æ¥ï¼Œå½“accept()æ¥å—åˆ°æ–°å®¢æˆ·ç«¯æ—¶ï¼Œç«‹å³è°ƒç”¨fork()åˆ›å»ºå­è¿›ç¨‹æ¥å¤„ç†è¯¥è¿æ¥ï¼Œè€Œä¸»è¿›ç¨‹ç»§ç»­ç›‘å¬ä¸‹ä¸€ä¸ªè¿æ¥ã€‚<br>
æ¯ä¸ªå­è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†ä¸åŒçš„å®¢æˆ·ç«¯è¯·æ±‚ã€‚<br>
è¿™ç§æ¨¡å‹æä¾›äº†æœ€å¼ºçš„éš”ç¦»æ€§ï¼Œä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹æˆ–ä¸»æœåŠ¡å™¨ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„é‡‡ç”¨ç»å…¸çš„fork-per-connectionæ¨¡å¼ã€‚</li>
<li>ä¸»è¿›ç¨‹åˆ›å»ºç›‘å¬socketåè¿›å…¥acceptå¾ªç¯ï¼Œæ¯æ¬¡æ¥å—æ–°è¿æ¥åç«‹å³fork()åˆ›å»ºå­è¿›ç¨‹ã€‚</li>
<li>å­è¿›ç¨‹å…³é—­ç›‘å¬socketï¼Œä¸“é—¨å¤„ç†åˆ†é…ç»™å®ƒçš„å®¢æˆ·ç«¯è¿æ¥ï¼Œå®Œæˆæ‰€æœ‰I/Oæ“ä½œåé€€å‡ºã€‚</li>
<li>ä¸»è¿›ç¨‹å…³é—­å®¢æˆ·ç«¯socketï¼Œç»§ç»­ç›‘å¬æ–°è¿æ¥ï¼Œå¹¶é€šè¿‡signalå¤„ç†æˆ–waitpid()å›æ”¶åƒµå°¸è¿›ç¨‹ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Main Process] --&gt; B[Listen Socket]
    B --&gt; C{New Connection?}
    C --&gt;|Yes| D[fork]
    D --&gt; E[Child Process 1]
    D --&gt; F[Child Process 2]
    D --&gt; G[Child Process N]
    E --&gt; H[Handle Client 1]
    F --&gt; I[Handle Client 2]
    G --&gt; J[Handle Client N]
    C --&gt;|No| C
    
    style E fill:#e1f5fe
    style F fill:#e1f5fe
    style G fill:#e1f5fe
</code></pre>
<h3 id="3-multithread-å¤šçº¿ç¨‹æ¨¡å‹">3. MultiThread (å¤šçº¿ç¨‹æ¨¡å‹)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>multi_thread_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: ä¸­ç­‰å¹¶å‘é‡çš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: çº¿ç¨‹åˆ›å»ºæ¯”è¿›ç¨‹å¿«ï¼Œå…±äº«å†…å­˜ç©ºé—´</li>
<li><strong>ç¼ºç‚¹</strong>: å¤§é‡è¿æ¥æ—¶çº¿ç¨‹æ•°è¿‡å¤šï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
å¤šçº¿ç¨‹æ¨¡å‹é€šè¿‡ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ›å»ºç‹¬ç«‹çº¿ç¨‹æ¥å®ç°å¹¶å‘å¤„ç†ã€‚<br>
ä¸»çº¿ç¨‹è´Ÿè´£ç›‘å¬å’Œæ¥å—æ–°è¿æ¥ï¼Œå½“æœ‰æ–°å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ¥å¤„ç†è¯¥è¿æ¥çš„æ‰€æœ‰I/Oæ“ä½œã€‚<br>
æ‰€æœ‰çº¿ç¨‹å…±äº«åŒä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å…±äº«æ•°æ®å’Œèµ„æºã€‚<br>
ç›¸æ¯”å¤šè¿›ç¨‹æ¨¡å‹ï¼Œçº¿ç¨‹çš„åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€æ›´å°ï¼Œå†…å­˜ä½¿ç”¨æ›´é«˜æ•ˆã€‚ä½†éœ€è¦ç‰¹åˆ«æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œé¿å…ç«æ€æ¡ä»¶å’Œæ•°æ®ç«äº‰ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºthread-per-connectionæ¨¡å¼ã€‚</li>
<li>ä¸»çº¿ç¨‹åˆ›å»ºç›‘å¬socketå¹¶è¿›å…¥acceptå¾ªç¯ï¼Œæ¯æ¥å—ä¸€ä¸ªæ–°è¿æ¥å°±è°ƒç”¨pthread_create()æˆ–std::threadåˆ›å»ºå·¥ä½œçº¿ç¨‹ã€‚</li>
<li>å·¥ä½œçº¿ç¨‹æ¥æ”¶å®¢æˆ·ç«¯socketæè¿°ç¬¦ä½œä¸ºå‚æ•°ï¼Œç‹¬ç«‹å¤„ç†è¯¥è¿æ¥çš„è¯»å†™æ“ä½œï¼Œå®Œæˆåè‡ªåŠ¨é€€å‡ºã€‚</li>
<li>ä¸ºäº†é¿å…çº¿ç¨‹æ³„æ¼ï¼Œé€šå¸¸é‡‡ç”¨detachedçº¿ç¨‹æˆ–åœ¨ä¸»çº¿ç¨‹ä¸­joinå›æ”¶ã€‚</li>
<li>å…±äº«èµ„æºï¼ˆå¦‚æ—¥å¿—ã€ç»Ÿè®¡ä¿¡æ¯ï¼‰éœ€è¦ä½¿ç”¨äº’æ–¥é”ä¿æŠ¤ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Main Thread] --&gt; B[Listen Socket]
    B --&gt; C{New Connection?}
    C --&gt;|Yes| D[Create Thread]
    D --&gt; E[Worker Thread 1]
    D --&gt; F[Worker Thread 2]
    D --&gt; G[Worker Thread N]
    E --&gt; H[Handle Client 1]
    F --&gt; I[Handle Client 2]
    G --&gt; J[Handle Client N]
    C --&gt;|No| C
    
    K[Shared Memory Space]
    E -.-&gt; K
    F -.-&gt; K
    G -.-&gt; K
    
    style E fill:#fff3e0
    style F fill:#fff3e0
    style G fill:#fff3e0
</code></pre>
<h3 id="4-processpool1-è¿›ç¨‹æ± æ¨¡å‹1">4. ProcessPool1 (è¿›ç¨‹æ± æ¨¡å‹1)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>process_pool1_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: é¢„å…ˆåˆ›å»ºå›ºå®šæ•°é‡çš„å·¥ä½œè¿›ç¨‹ï¼Œå…±äº«ç›‘å¬socket</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: é«˜å¹¶å‘åœºæ™¯ï¼Œéœ€è¦è¿›ç¨‹éš”ç¦»</li>
<li><strong>ä¼˜ç‚¹</strong>: é¿å…é¢‘ç¹åˆ›å»ºè¿›ç¨‹ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜</li>
<li><strong>ç¼ºç‚¹</strong>: è¿›ç¨‹é—´ç«äº‰acceptå¯èƒ½ä¸å‡åŒ€</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Master Process] --&gt; B[Create Process Pool]
    B --&gt; C[Worker Process 1]
    B --&gt; D[Worker Process 2]
    B --&gt; E[Worker Process N]
    
    F[Shared Listen Socket] --&gt; G{accept}
    C --&gt; G
    D --&gt; G
    E --&gt; G
    
    G --&gt;|Process 1 wins| H[Handle Client 1]
    G --&gt;|Process 2 wins| I[Handle Client 2]
    G --&gt;|Process N wins| J[Handle Client N]
    
    style C fill:#e8f5e8
    style D fill:#e8f5e8
    style E fill:#e8f5e8
    style F fill:#ffecb3
</code></pre>
<h3 id="5-processpool2-è¿›ç¨‹æ± æ¨¡å‹2---so_reuseport">5. ProcessPool2 (è¿›ç¨‹æ± æ¨¡å‹2 - SO_REUSEPORT)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>process_pool2_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä½¿ç”¨SO_REUSEPORTé€‰é¡¹ï¼Œæ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹ç›‘å¬åŒä¸€ç«¯å£</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: Linuxç¯å¢ƒä¸‹çš„é«˜å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: å†…æ ¸è´Ÿè½½å‡è¡¡ï¼Œé¿å…æƒŠç¾¤æ•ˆåº”</li>
<li><strong>ç¼ºç‚¹</strong>: ä¾èµ–æ“ä½œç³»ç»Ÿç‰¹æ€§ï¼Œå¯ç§»æ¤æ€§æœ‰é™</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Master Process] --&gt; B[Create Process Pool]
    B --&gt; C[Worker Process 1]
    B --&gt; D[Worker Process 2]
    B --&gt; E[Worker Process N]
    
    F[Port 8080] --&gt; G[SO_REUSEPORT]
    C --&gt; H[Listen Socket 1]
    D --&gt; I[Listen Socket 2]
    E --&gt; J[Listen Socket N]
    
    G --&gt; H
    G --&gt; I
    G --&gt; J
    
    K[Kernel Load Balancer] --&gt; H
    K --&gt; I
    K --&gt; J
    
    style C fill:#e8f5e8
    style D fill:#e8f5e8
    style E fill:#e8f5e8
    style K fill:#f3e5f5
</code></pre>
<h3 id="6-threadpool-çº¿ç¨‹æ± æ¨¡å‹">6. ThreadPool (çº¿ç¨‹æ± æ¨¡å‹)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>thread_pool_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: é¢„å…ˆåˆ›å»ºå›ºå®šæ•°é‡çš„å·¥ä½œçº¿ç¨‹</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: é«˜å¹¶å‘WebæœåŠ¡å™¨</li>
<li><strong>ä¼˜ç‚¹</strong>: é¿å…é¢‘ç¹åˆ›å»ºçº¿ç¨‹ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜</li>
<li><strong>ç¼ºç‚¹</strong>: çº¿ç¨‹æ•°å›ºå®šï¼Œå¯èƒ½æ— æ³•é€‚åº”è´Ÿè½½å˜åŒ–</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
çº¿ç¨‹æ± æ¨¡å‹é€šè¿‡é¢„å…ˆåˆ›å»ºå›ºå®šæ•°é‡çš„å·¥ä½œçº¿ç¨‹æ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œé¿å…äº†ä¸ºæ¯ä¸ªè¿æ¥åŠ¨æ€åˆ›å»ºçº¿ç¨‹çš„å¼€é”€ã€‚<br>
ä¸»çº¿ç¨‹è´Ÿè´£æ¥å—æ–°è¿æ¥å¹¶å°†è¿æ¥æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå·¥ä½œçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚<br>
è¿™ç§æ¨¡å‹æœ‰æ•ˆæ§åˆ¶äº†ç³»ç»Ÿèµ„æºä½¿ç”¨ï¼Œé¿å…äº†çº¿ç¨‹æ•°é‡æ— é™å¢é•¿å¯¼è‡´çš„ç³»ç»Ÿå´©æºƒã€‚<br>
çº¿ç¨‹æ± çš„å¤§å°é€šå¸¸æ ¹æ®CPUæ ¸å¿ƒæ•°å’Œé¢„æœŸè´Ÿè½½æ¥è®¾å®šï¼Œå®ç°äº†æ›´å¥½çš„èµ„æºç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„é‡‡ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ã€‚</li>
<li>ç³»ç»Ÿå¯åŠ¨æ—¶é¢„åˆ›å»ºæŒ‡å®šæ•°é‡çš„å·¥ä½œçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸Šç­‰å¾…ã€‚</li>
<li>ä¸»çº¿ç¨‹acceptæ–°è¿æ¥åï¼Œå°†å®¢æˆ·ç«¯socketå°è£…æˆä»»åŠ¡å¯¹è±¡æ”¾å…¥çº¿ç¨‹å®‰å…¨çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</li>
<li>ä½œçº¿ç¨‹é€šè¿‡æ¡ä»¶å˜é‡ç­‰å¾…ä»»åŠ¡ï¼Œå–åˆ°ä»»åŠ¡åå¤„ç†å®Œæ•´çš„å®¢æˆ·ç«¯äº¤äº’æµç¨‹ã€‚ä»»åŠ¡é˜Ÿåˆ—é€šå¸¸ä½¿ç”¨äº’æ–¥é”å’Œæ¡ä»¶å˜é‡å®ç°åŒæ­¥ã€‚</li>
<li>å½“å·¥ä½œçº¿ç¨‹å¤„ç†å®Œä¸€ä¸ªä»»åŠ¡åï¼Œä¼šå°†è‡ªå·±é‡æ–°åŠ å…¥çº¿ç¨‹æ± ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Main Thread] --&gt; B[Create Thread Pool]
    B --&gt; C[Worker Thread 1]
    B --&gt; D[Worker Thread 2]
    B --&gt; E[Worker Thread N]
    
    A --&gt; F[Accept Connections]
    F --&gt; G[Task Queue]
    
    C --&gt; H{Get Task}
    D --&gt; I{Get Task}
    E --&gt; J{Get Task}
    
    G --&gt; H
    G --&gt; I
    G --&gt; J
    
    H --&gt; K[Process Client]
    I --&gt; L[Process Client]
    J --&gt; M[Process Client]
    
    style C fill:#fff3e0
    style D fill:#fff3e0
    style E fill:#fff3e0
    style G fill:#e3f2fd
</code></pre>
<h3 id="7-leaderandfollower-é¢†å¯¼è€…è·Ÿéšè€…æ¨¡å‹">7. LeaderAndFollower (é¢†å¯¼è€…/è·Ÿéšè€…æ¨¡å‹)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>leader_follower_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: çº¿ç¨‹æ± å˜ç§ï¼Œä¸€ä¸ªçº¿ç¨‹ä½œä¸ºleaderç›‘å¬è¿æ¥</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦ç²¾ç¡®æ§åˆ¶çº¿ç¨‹è¡Œä¸ºçš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: å‡å°‘çº¿ç¨‹é—´ç«äº‰ï¼Œæé«˜ç¼“å­˜å±€éƒ¨æ€§</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚ï¼Œè°ƒè¯•å›°éš¾</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
é¢†å¯¼è€…/è·Ÿéšè€…æ¨¡å‹æ˜¯ä¸€ç§é«˜æ€§èƒ½çš„å¹¶å‘æ¨¡å¼ï¼Œé€šè¿‡åŠ¨æ€è§’è‰²åˆ‡æ¢æ¥ä¼˜åŒ–çº¿ç¨‹åˆ©ç”¨ç‡ã€‚ <br>
åœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‹…ä»»é¢†å¯¼è€…è§’è‰²ï¼Œè´Ÿè´£ç›‘å¬å’Œæ¥å—æ–°çš„è¿æ¥æˆ–äº‹ä»¶ï¼Œå…¶ä»–çº¿ç¨‹å¤„äºè·Ÿéšè€…çŠ¶æ€ç­‰å¾…è¢«æ¿€æ´»ã€‚ <br>
å½“é¢†å¯¼è€…æ¥æ”¶åˆ°äº‹ä»¶åï¼Œå®ƒä¼šå°†è‡ªå·±é™çº§ä¸ºè·Ÿéšè€…å»å¤„ç†è¯¥äº‹ä»¶ï¼ŒåŒæ—¶ä»è·Ÿéšè€…ä¸­é€‰ä¸¾å‡ºæ–°çš„é¢†å¯¼è€…ç»§ç»­ç›‘å¬ã€‚ <br>
è¿™ç§æ¨¡å‹é¿å…äº†ä¼ ç»Ÿæ¨¡å‹ä¸­çš„çº¿ç¨‹æ± è°ƒåº¦å¼€é”€ï¼Œå‡å°‘äº†çº¿ç¨‹é—´çš„ç«äº‰ï¼Œæé«˜äº†CPUç¼“å­˜çš„å±€éƒ¨æ€§ã€‚ç‰¹åˆ«é€‚åˆé«˜å¹¶å‘ã€ä½å»¶è¿Ÿçš„ç½‘ç»œæœåŠ¡åœºæ™¯ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºçº¿ç¨‹æ± å’Œè§’è‰²ç®¡ç†æœºåˆ¶æ„å»ºã€‚</li>
<li>ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‹…ä»»é¢†å¯¼è€…ï¼Œå…¶ä½™çº¿ç¨‹ä¸ºè·Ÿéšè€…ã€‚</li>
<li>é¢†å¯¼è€…çº¿ç¨‹è´Ÿè´£åœ¨äº‹ä»¶å¤šè·¯å¤ç”¨å™¨ï¼ˆå¦‚epollï¼‰ä¸Šç­‰å¾…I/Oäº‹ä»¶ã€‚</li>
<li>å½“äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œé¢†å¯¼è€…é¦–å…ˆä»è·Ÿéšè€…ä¸­é€‰æ‹©ä¸€ä¸ªçº¿ç¨‹æå‡ä¸ºæ–°é¢†å¯¼è€…ï¼Œç„¶åè‡ªå·±é™çº§ä¸ºå·¥ä½œçº¿ç¨‹å¤„ç†è¯¥äº‹ä»¶ï¼Œè§’è‰²åˆ‡æ¢é€šè¿‡æ¡ä»¶å˜é‡å’Œäº’æ–¥é”å®ç°åŒæ­¥ã€‚</li>
<li>ä¸ºäº†é¿å…æƒŠç¾¤æ•ˆåº”ï¼Œåªæœ‰é¢†å¯¼è€…çº¿ç¨‹åœ¨äº‹ä»¶å¤šè·¯å¤ç”¨å™¨ä¸Šç­‰å¾…ã€‚</li>
<li>å¤„ç†å®Œäº‹ä»¶çš„çº¿ç¨‹ä¼šé‡æ–°åŠ å…¥è·Ÿéšè€…é˜Ÿåˆ—ç­‰å¾…ä¸‹æ¬¡è¢«é€‰ä¸ºé¢†å¯¼è€…ã€‚</li>
</ul>
<pre><code class="language-mermaid">stateDiagram-v2
    [*] --&gt; Leader: Thread becomes leader
    Leader --&gt; Processing: Accept connection
    Processing --&gt; Follower: Promote next follower
    Follower --&gt; Leader: Wait for promotion
    Processing --&gt; [*]: Complete request
    
    state Leader {
        [*] --&gt; Listening
        Listening --&gt; AcceptConnection: New connection
        AcceptConnection --&gt; [*]
    }
    
    state Processing {
        [*] --&gt; HandleRequest
        HandleRequest --&gt; SendResponse
        SendResponse --&gt; [*]
    }
</code></pre>
<h3 id="8-select-select-ioå¤šè·¯å¤ç”¨">8. Select (Select I/Oå¤šè·¯å¤ç”¨)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>select_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä½¿ç”¨selectç³»ç»Ÿè°ƒç”¨ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: è·¨å¹³å°çš„ä¸­ç­‰å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: è·¨å¹³å°å…¼å®¹æ€§å¥½</li>
<li><strong>ç¼ºç‚¹</strong>: æ–‡ä»¶æè¿°ç¬¦æ•°é‡æœ‰é™åˆ¶ï¼Œæ€§èƒ½éšè¿æ¥æ•°çº¿æ€§ä¸‹é™</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Selectæ¨¡å‹æ˜¯æœ€ç»å…¸çš„I/Oå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œé€šè¿‡select()ç³»ç»Ÿè°ƒç”¨åœ¨å•çº¿ç¨‹ä¸­åŒæ—¶ç›‘æ§å¤šä¸ªsocketçš„çŠ¶æ€å˜åŒ–ã€‚<br>
æœåŠ¡å™¨ç»´æŠ¤è¯»ã€å†™ã€å¼‚å¸¸ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œselect()ä¼šé˜»å¡ç­‰å¾…ç›´åˆ°è‡³å°‘ä¸€ä¸ªæè¿°ç¬¦å°±ç»ªã€‚<br>
å½“select()è¿”å›æ—¶ï¼ŒæœåŠ¡å™¨éå†æè¿°ç¬¦é›†åˆï¼Œå¤„ç†æ‰€æœ‰å°±ç»ªçš„I/Oæ“ä½œã€‚<br>
è¿™ç§æ¨¡å‹é¿å…äº†å¤šçº¿ç¨‹çš„å¤æ‚æ€§ï¼Œç”¨å•çº¿ç¨‹å°±èƒ½å¤„ç†å¤šä¸ªå¹¶å‘è¿æ¥ï¼Œæ˜¯äº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„åŸºç¡€ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºäº‹ä»¶å¾ªç¯æ¨¡å¼ã€‚</li>
<li>æœåŠ¡å™¨åˆå§‹åŒ–æ—¶å°†ç›‘å¬socketåŠ å…¥è¯»æè¿°ç¬¦é›†åˆï¼Œç„¶åè¿›å…¥ä¸»å¾ªç¯è°ƒç”¨select()ç­‰å¾…äº‹ä»¶ã€‚</li>
<li>å½“æœ‰æ–°è¿æ¥æ—¶ï¼Œaccept()åå°†å®¢æˆ·ç«¯socketåŠ å…¥ç›‘æ§é›†åˆï¼›å½“å®¢æˆ·ç«¯socketå¯è¯»æ—¶ï¼Œè¯»å–å¹¶å¤„ç†è¯·æ±‚ï¼›å½“å¯å†™æ—¶ï¼Œå‘é€å“åº”æ•°æ®ã€‚</li>
<li>æ¯æ¬¡å¾ªç¯éƒ½éœ€è¦é‡æ–°è®¾ç½®æè¿°ç¬¦é›†åˆï¼Œå› ä¸ºselect()ä¼šä¿®æ”¹ä¼ å…¥çš„é›†åˆã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Main Loop] --&gt; B[fd_set readfds]
    B --&gt; C[Add listen_fd]
    B --&gt; D[Add client_fd1]
    B --&gt; E[Add client_fd2]
    B --&gt; F[Add client_fdN]
    
    G[select] --&gt; H{Ready FDs?}
    C --&gt; G
    D --&gt; G
    E --&gt; G
    F --&gt; G
    
    H --&gt;|listen_fd ready| I[Accept new connection]
    H --&gt;|client_fd ready| J[Read/Write data]
    H --&gt;|timeout| K[Continue loop]
    
    I --&gt; A
    J --&gt; A
    K --&gt; A
    
    style B fill:#e1f5fe
    style G fill:#fff3e0
</code></pre>
<h3 id="9-poll-poll-ioå¤šè·¯å¤ç”¨">9. Poll (Poll I/Oå¤šè·¯å¤ç”¨)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>poll_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä½¿ç”¨pollç³»ç»Ÿè°ƒç”¨ï¼Œæ”¹è¿›äº†selectçš„é™åˆ¶</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: ä¸­ç­‰å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: æ²¡æœ‰æ–‡ä»¶æè¿°ç¬¦æ•°é‡é™åˆ¶</li>
<li><strong>ç¼ºç‚¹</strong>: æ€§èƒ½ä»éšè¿æ¥æ•°çº¿æ€§ä¸‹é™</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Pollæ¨¡å‹æ˜¯selectæ¨¡å‹çš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä½¿ç”¨poll()ç³»ç»Ÿè°ƒç”¨æ¥ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„I/Oäº‹ä»¶ã€‚<br>
ä¸selectä¸åŒï¼Œpollä½¿ç”¨pollfdç»“æ„æ•°ç»„æ¥æè¿°è¦ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦å’Œäº‹ä»¶ç±»å‹ï¼Œæ²¡æœ‰FD_SETSIZEçš„é™åˆ¶ï¼Œå¯ä»¥ç›‘æ§ä»»æ„æ•°é‡çš„æè¿°ç¬¦ã€‚<br>
poll()è¿”å›æ—¶ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸ªpollfdç»“æ„çš„reventså­—æ®µæ¥ç¡®å®šå“ªäº›æè¿°ç¬¦å°±ç»ªã€‚è¿™ç§æ¨¡å‹ä¿æŒäº†selectçš„å•çº¿ç¨‹ä¼˜åŠ¿ï¼ŒåŒæ—¶è§£å†³äº†æè¿°ç¬¦æ•°é‡é™åˆ¶é—®é¢˜ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŒæ ·åŸºäºäº‹ä»¶å¾ªç¯ï¼Œä½†ä½¿ç”¨æ›´çµæ´»çš„æ•°æ®ç»“æ„ã€‚</li>
<li>æœåŠ¡å™¨ç»´æŠ¤ä¸€ä¸ªåŠ¨æ€çš„pollfdæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å«æ–‡ä»¶æè¿°ç¬¦ã€å…³æ³¨çš„äº‹ä»¶å’Œè¿”å›çš„äº‹ä»¶ã€‚</li>
<li>ä¸»å¾ªç¯è°ƒç”¨poll()ç­‰å¾…äº‹ä»¶ï¼Œè¿”å›åéå†æ•°ç»„æ£€æŸ¥reventså­—æ®µã€‚</li>
<li>å½“æœ‰æ–°è¿æ¥æ—¶ï¼ŒåŠ¨æ€æ‰©å±•pollfdæ•°ç»„ï¼›å½“è¿æ¥å…³é—­æ—¶ï¼Œä»æ•°ç»„ä¸­ç§»é™¤å¯¹åº”å…ƒç´ ã€‚</li>
<li>ç›¸æ¯”selectï¼Œpollçš„æ¥å£æ›´æ¸…æ™°ï¼Œä¸éœ€è¦é‡å¤è®¾ç½®æè¿°ç¬¦é›†åˆã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Main Loop] --&gt; B[pollfd array]
    B --&gt; C[&quot;pollfd[0]: listen_fd&quot;]
    B --&gt; D[&quot;pollfd[1]: client_fd1&quot;]
    B --&gt; E[&quot;pollfd[2]: client_fd2&quot;]
    B --&gt; F[&quot;pollfd[N]: client_fdN&quot;]
    
    G[poll] --&gt; H{Check revents}
    C --&gt; G
    D --&gt; G
    E --&gt; G
    F --&gt; G
    
    H --&gt;|POLLIN on listen_fd| I[Accept new connection]
    H --&gt;|POLLIN on client_fd| J[Read data]
    H --&gt;|POLLOUT on client_fd| K[Write data]
    H --&gt;|POLLHUP/POLLERR| L[Close connection]
    
    I --&gt; M[Add to pollfd array]
    J --&gt; A
    K --&gt; A
    L --&gt; N[Remove from array]
    M --&gt; A
    N --&gt; A
    
    style B fill:#e8f5e8
    style G fill:#fff3e0
</code></pre>
<h3 id="10-epoll-epoll-ioå¤šè·¯å¤ç”¨">10. Epoll (Epoll I/Oå¤šè·¯å¤ç”¨)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>epoll_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: Linuxç‰¹æœ‰çš„é«˜æ•ˆI/Oå¤šè·¯å¤ç”¨æœºåˆ¶</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: Linuxç¯å¢ƒä¸‹çš„é«˜å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: æ€§èƒ½ä¼˜ç§€ï¼Œæ”¯æŒè¾¹ç¼˜è§¦å‘</li>
<li><strong>ç¼ºç‚¹</strong>: ä»…é™Linuxç³»ç»Ÿ</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Epollæ˜¯Linuxå†…æ ¸æä¾›çš„é«˜æ€§èƒ½I/Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œä¸“é—¨ä¸ºè§£å†³C10Ké—®é¢˜è€Œè®¾è®¡ã€‚ <br>
ä¸select/pollä¸åŒï¼Œepollä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼ï¼Œåªè¿”å›å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé¿å…äº†çº¿æ€§æ‰«æã€‚ <br>
Epollå†…éƒ¨ä½¿ç”¨çº¢é»‘æ ‘ç®¡ç†æ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿ç”¨å°±ç»ªåˆ—è¡¨å­˜å‚¨æ´»è·ƒäº‹ä»¶ï¼Œå®ç°äº†O(1)çš„äº‹ä»¶é€šçŸ¥æ•ˆç‡ã€‚
æ”¯æŒæ°´å¹³è§¦å‘(LT)å’Œè¾¹ç¼˜è§¦å‘(ET)ä¸¤ç§æ¨¡å¼ï¼Œä¸ºé«˜æ€§èƒ½æœåŠ¡å™¨æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºepollçš„ä¸‰ä¸ªæ ¸å¿ƒç³»ç»Ÿè°ƒç”¨ï¼šepoll_createåˆ›å»ºepollå®ä¾‹ï¼Œepoll_ctlç®¡ç†ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œepoll_waitç­‰å¾…äº‹ä»¶ã€‚</li>
<li>æœåŠ¡å™¨å¯åŠ¨æ—¶åˆ›å»ºepollå®ä¾‹ï¼Œå°†ç›‘å¬socketåŠ å…¥ç›‘æ§ã€‚ä¸»å¾ªç¯è°ƒç”¨epoll_waitç­‰å¾…äº‹ä»¶ï¼Œåªå¤„ç†è¿”å›çš„å°±ç»ªæè¿°ç¬¦ï¼Œæ— éœ€éå†æ‰€æœ‰è¿æ¥ã€‚</li>
<li>æ–°è¿æ¥é€šè¿‡epoll_ctlæ·»åŠ åˆ°ç›‘æ§é›†åˆï¼Œå…³é—­è¿æ¥æ—¶ç§»é™¤ã€‚</li>
<li>æ”¯æŒEPOLLINã€EPOLLOUTã€EPOLLETç­‰å¤šç§äº‹ä»¶ç±»å‹ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[epoll_create] --&gt; B[epoll_fd]
    B --&gt; C[epoll_ctl ADD listen_fd]
    
    D[Main Loop] --&gt; E[epoll_wait]
    E --&gt; F{Ready Events?}
    
    F --&gt;|listen_fd EPOLLIN| G[Accept connection]
    F --&gt;|client_fd EPOLLIN| H[Read data]
    F --&gt;|client_fd EPOLLOUT| I[Write data]
    F --&gt;|client_fd EPOLLHUP| J[Close connection]
    
    G --&gt; K[epoll_ctl ADD client_fd]
    H --&gt; L[Process request]
    I --&gt; M[Send response]
    J --&gt; N[epoll_ctl DEL client_fd]
    
    K --&gt; D
    L --&gt; D
    M --&gt; D
    N --&gt; D
    
    style B fill:#ffecb3
    style E fill:#e8f5e8
    style F fill:#f3e5f5
</code></pre>
<h3 id="11-kqueue-kqueue-ioå¤šè·¯å¤ç”¨">11. Kqueue (Kqueue I/Oå¤šè·¯å¤ç”¨)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>kqueue_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: BSD/macOSç‰¹æœ‰çš„é«˜æ•ˆI/Oå¤šè·¯å¤ç”¨æœºåˆ¶</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: BSD/macOSç¯å¢ƒä¸‹çš„é«˜å¹¶å‘åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: æ€§èƒ½ä¼˜ç§€ï¼ŒåŠŸèƒ½ä¸°å¯Œ</li>
<li><strong>ç¼ºç‚¹</strong>: ä»…é™BSD/macOSç³»ç»Ÿ</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Kqueueæ˜¯FreeBSDå’ŒmacOSç³»ç»Ÿæä¾›çš„é«˜æ€§èƒ½äº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œç±»ä¼¼äºLinuxçš„epollä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚<br>
Kqueueä¸ä»…æ”¯æŒç½‘ç»œI/Oäº‹ä»¶ï¼Œè¿˜æ”¯æŒæ–‡ä»¶ç³»ç»Ÿå˜åŒ–ã€ä¿¡å·ã€å®šæ—¶å™¨ç­‰å¤šç§äº‹ä»¶ç±»å‹ã€‚é€šè¿‡kevent()ç³»ç»Ÿè°ƒç”¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰äº‹ä»¶ï¼Œæä¾›äº†ä¸€è‡´çš„ç¼–ç¨‹æ¥å£ã€‚<br>
Kqueueä½¿ç”¨å†…æ ¸äº‹ä»¶é˜Ÿåˆ—ï¼Œåªé€šçŸ¥å‘ç”Ÿå˜åŒ–çš„äº‹ä»¶ï¼Œé¿å…äº†è½®è¯¢å¼€é”€ã€‚<br>
å…¶è®¾è®¡å“²å­¦æ˜¯æä¾›ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†æ¡†æ¶ï¼Œè®©åº”ç”¨ç¨‹åºèƒ½å¤Ÿé«˜æ•ˆåœ°å“åº”å„ç§ç³»ç»Ÿäº‹ä»¶ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„å›´ç»•kqueue()å’Œkevent()ä¸¤ä¸ªæ ¸å¿ƒç³»ç»Ÿè°ƒç”¨æ„å»ºã€‚</li>
<li>æœåŠ¡å™¨å¯åŠ¨æ—¶è°ƒç”¨kqueue()åˆ›å»ºäº‹ä»¶é˜Ÿåˆ—ï¼Œç„¶åä½¿ç”¨kevent()æ³¨å†Œæ„Ÿå…´è¶£çš„äº‹ä»¶ï¼ˆå¦‚ç›‘å¬socketçš„è¯»äº‹ä»¶ï¼‰ã€‚</li>
<li>ä¸»å¾ªç¯è°ƒç”¨kevent()ç­‰å¾…äº‹ä»¶ï¼Œè¯¥å‡½æ•°æ—¢ç”¨äºæ³¨å†Œäº‹ä»¶ä¹Ÿç”¨äºè·å–å°±ç»ªäº‹ä»¶ã€‚</li>
<li>å½“æœ‰äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œkevent()è¿”å›äº‹ä»¶æ•°ç»„ï¼ŒåŒ…å«äº‹ä»¶ç±»å‹ã€æ–‡ä»¶æè¿°ç¬¦ã€æ•°æ®ç­‰ä¿¡æ¯ã€‚æ”¯æŒEVFILT_READã€EVFILT_WRITEã€EVFILT_TIMERç­‰å¤šç§è¿‡æ»¤å™¨ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[kqueue] --&gt; B[kqueue_fd]
    B --&gt; C[&quot;EV_SET(listen_fd, EVFILT_READ)&quot;]
    C --&gt; D[kevent register]
    
    E[Main Loop] --&gt; F[kevent wait]
    F --&gt; G{Ready Events?}
    
    G --&gt;|listen_fd READ| H[Accept connection]
    G --&gt;|client_fd read| I[Read data]
    G --&gt;|client_fd write| J[Write data]
    G --&gt;|EOF/Error| K[Close connection]
    
    H --&gt; L[&quot;EV_SET(client_fd, EVFILT_READ)&quot;]
    I --&gt; M[Process request]
    J --&gt; N[Send response]
    K --&gt; O[Remove from kqueue]
    
    L --&gt; P[kevent add]
    M --&gt; E
    N --&gt; E
    O --&gt; E
    P --&gt; E
    
    style B fill:#ffecb3
    style F fill:#e8f5e8
    style G fill:#f3e5f5
</code></pre>
<h3 id="12-reactor-reactoræ¨¡å¼">12. Reactor (Reactoræ¨¡å¼)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>reactor_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œç¼–ç¨‹æ¨¡å¼</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦ç²¾ç¡®æ§åˆ¶äº‹ä»¶å¤„ç†çš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚åº¦è¾ƒé«˜</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Reactoræ¨¡å¼æ˜¯ä¸€ç§äº‹ä»¶é©±åŠ¨çš„è®¾è®¡æ¨¡å¼ï¼Œå°†äº‹ä»¶æ£€æµ‹å’Œäº‹ä»¶å¤„ç†åˆ†ç¦»ï¼Œæä¾›äº†é«˜åº¦å¯æ‰©å±•çš„æ¶æ„ã€‚ <br>
è¯¥æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œè´Ÿè´£ç›‘å¬å„ç§I/Oäº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶åˆ†å‘ç»™ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨ã€‚ <br>
Reactoræ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯&quot;ä¸è¦è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ &quot;ï¼Œåº”ç”¨ç¨‹åºæ³¨å†Œäº‹ä»¶å¤„ç†å™¨ï¼Œç”±Reactorè´Ÿè´£åœ¨é€‚å½“æ—¶æœºè°ƒç”¨ã€‚ <br>
è¿™ç§æ¨¡å¼å¹¿æ³›åº”ç”¨äºç½‘ç»œç¼–ç¨‹æ¡†æ¶ï¼Œå¦‚Java NIOã€Node.jsç­‰ï¼Œæä¾›äº†ä¼˜é›…çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŒ…å«å‡ ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šReactorè´Ÿè´£äº‹ä»¶å¾ªç¯å’Œåˆ†å‘ï¼ŒDemultiplexerè´Ÿè´£I/Oäº‹ä»¶æ£€æµ‹ï¼ˆå¦‚epoll/selectï¼‰ï¼ŒEventHandlerå®šä¹‰äº‹ä»¶å¤„ç†æ¥å£ï¼ŒConcreteHandlerå®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œå„ç§å¤„ç†å™¨æ³¨å†Œåˆ°Reactorï¼ŒæŒ‡å®šå…³æ³¨çš„äº‹ä»¶ç±»å‹ã€‚</li>
<li>Reactorè¿›å…¥äº‹ä»¶å¾ªç¯ï¼Œè°ƒç”¨Demultiplexerç­‰å¾…äº‹ä»¶ï¼Œå½“äº‹ä»¶å°±ç»ªæ—¶æŸ¥æ‰¾å¯¹åº”çš„å¤„ç†å™¨å¹¶è°ƒç”¨å…¶å¤„ç†æ–¹æ³•ã€‚</li>
<li>æ”¯æŒAcceptHandlerå¤„ç†æ–°è¿æ¥ã€ReadHandlerå¤„ç†è¯»äº‹ä»¶ã€WriteHandlerå¤„ç†å†™äº‹ä»¶ç­‰ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Reactor] --&gt; B[Event Demultiplexer]
    B --&gt; C[select/poll/epoll]
    
    D[Event Handlers] --&gt; E[AcceptHandler]
    D --&gt; F[ReadHandler]
    D --&gt; G[WriteHandler]
    
    H[Main Loop] --&gt; I[Handle Events]
    I --&gt; J{Event Type?}
    
    J --&gt;|Accept Event| K[AcceptHandler.handle]
    J --&gt;|Read Event| L[ReadHandler.handle]
    J --&gt;|Write Event| M[WriteHandler.handle]
    
    K --&gt; N[Create new connection]
    L --&gt; O[Read and process data]
    M --&gt; P[Send response]
    
    N --&gt; Q[Register with Reactor]
    O --&gt; R[Update event interest]
    P --&gt; S[Update event interest]
    
    Q --&gt; H
    R --&gt; H
    S --&gt; H
    
    style A fill:#e3f2fd
    style D fill:#fff3e0
    style I fill:#e8f5e8
</code></pre>
<h3 id="13-coroutine-åç¨‹æ¨¡å¼">13. Coroutine (åç¨‹æ¨¡å¼)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>coroutine_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä½¿ç”¨çŠ¶æ€æœºæ¨¡æ‹Ÿåç¨‹è¡Œä¸ºï¼ˆC++11å…¼å®¹ï¼‰</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: å¼‚æ­¥å¤„ç†åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: å†…å­˜æ¶ˆè€—å°‘ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¿«</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚ï¼Œè°ƒè¯•å›°éš¾</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
åç¨‹æ¨¡å¼é€šè¿‡çŠ¶æ€æœºæ¨¡æ‹Ÿåç¨‹è¡Œä¸ºï¼Œåœ¨C++11ç¯å¢ƒä¸‹å®ç°å¼‚æ­¥ç¼–ç¨‹ã€‚ä¸ä¼ ç»Ÿçš„å›è°ƒæ–¹å¼ä¸åŒï¼Œåç¨‹å…è®¸å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœå¹¶åœ¨ç¨åæ¢å¤ï¼Œä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ã€‚ <br>
æœ¬å®ç°ä½¿ç”¨çŠ¶æ€æœºæ¥è·Ÿè¸ªæ¯ä¸ªè¿æ¥çš„å¤„ç†çŠ¶æ€ï¼Œå½“é‡åˆ°ä¼šé˜»å¡çš„I/Oæ“ä½œæ—¶ï¼Œåç¨‹ä¼šyieldè®©å‡ºæ§åˆ¶æƒï¼Œç­‰å¾…I/Oå°±ç»ªåå†resumeç»§ç»­æ‰§è¡Œã€‚ <br>
è¿™ç§æ¨¡å‹ç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼Œå› ä¸ºåç¨‹çš„å†…å­˜å¼€é”€è¿œå°äºçº¿ç¨‹ï¼Œå¯ä»¥åˆ›å»ºæˆåƒä¸Šä¸‡ä¸ªåç¨‹è€Œä¸ä¼šè€—å°½ç³»ç»Ÿèµ„æºã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºçŠ¶æ€æœºå’Œäº‹ä»¶å¾ªç¯æ„å»ºã€‚</li>
<li>æ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥å¯¹åº”ä¸€ä¸ªåç¨‹å¯¹è±¡ï¼ŒåŒ…å«å½“å‰çŠ¶æ€ã€ä¸Šä¸‹æ–‡æ•°æ®å’ŒçŠ¶æ€è½¬æ¢é€»è¾‘ã€‚åç¨‹è°ƒåº¦å™¨ç»´æŠ¤æ‰€æœ‰æ´»è·ƒåç¨‹çš„åˆ—è¡¨ï¼Œåœ¨äº‹ä»¶å¾ªç¯ä¸­è½®è¯¢I/Oäº‹ä»¶ã€‚</li>
<li>å½“socketå°±ç»ªæ—¶ï¼Œè°ƒåº¦å™¨æ¢å¤å¯¹åº”åç¨‹çš„æ‰§è¡Œã€‚</li>
<li>åç¨‹å†…éƒ¨ä½¿ç”¨çŠ¶æ€æœºå®ç°ï¼šINITçŠ¶æ€åˆå§‹åŒ–è¿æ¥ï¼ŒREADINGçŠ¶æ€å¤„ç†è¯»å–ï¼ŒPROCESSINGçŠ¶æ€å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ŒWRITINGçŠ¶æ€å‘é€å“åº”ï¼ŒDONEçŠ¶æ€æ¸…ç†èµ„æºã€‚</li>
<li>æ¯ä¸ªçŠ¶æ€éƒ½å¯èƒ½å› ä¸ºI/Oé˜»å¡è€Œyieldï¼Œè°ƒåº¦å™¨ä¼šåœ¨ä¸‹æ¬¡å¾ªç¯ä¸­æ£€æŸ¥å¹¶æ¢å¤ã€‚</li>
</ul>
<pre><code class="language-mermaid">stateDiagram-v2
    [*] --&gt; INIT: Create Coroutine
    INIT --&gt; READING: Start read operation
    READING --&gt; PROCESSING: Data available
    READING --&gt; READING: Would block (yield)
    PROCESSING --&gt; WRITING: Process complete
    WRITING --&gt; WRITING: Would block (yield)
    WRITING --&gt; DONE: Write complete
    DONE --&gt; [*]: Coroutine finished
    
    state READING {
        [*] --&gt; CheckSocket
        CheckSocket --&gt; ReadData: Socket ready
        CheckSocket --&gt; Yield: Would block
        ReadData --&gt; [*]: Data read
        Yield --&gt; [*]: Resume later
    }
    
    state WRITING {
        [*] --&gt; CheckSocket
        CheckSocket --&gt; WriteData: Socket ready
        CheckSocket --&gt; Yield: Would block
        WriteData --&gt; [*]: Data written
        Yield --&gt; [*]: Resume later
    }
</code></pre>
<h3 id="14-actoræ¨¡å‹">14. Actoræ¨¡å‹</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>actor_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: æ¯ä¸ªActoræ˜¯ç‹¬ç«‹çš„è®¡ç®—å•å…ƒï¼Œé€šè¿‡æ¶ˆæ¯ä¼ é€’é€šä¿¡</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: åˆ†å¸ƒå¼ç³»ç»Ÿã€é«˜å¹¶å‘æ¶ˆæ¯å¤„ç†</li>
<li><strong>ä¼˜ç‚¹</strong>: æ— å…±äº«çŠ¶æ€ï¼Œå¤©ç„¶é¿å…ç«æ€æ¡ä»¶</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚ï¼Œæ¶ˆæ¯ä¼ é€’å¼€é”€</li>
<li><strong>å®ç°</strong>: å¯ä»¥åŸºäºçº¿ç¨‹æ±  + æ¶ˆæ¯é˜Ÿåˆ—å®ç°</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Actoræ¨¡å‹æ˜¯ä¸€ç§åŸºäºæ¶ˆæ¯ä¼ é€’çš„å¹¶å‘è®¡ç®—æ¨¡å‹ï¼Œæ¯ä¸ªActoréƒ½æ˜¯ç‹¬ç«‹çš„è®¡ç®—å•å…ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€å’Œè¡Œä¸ºã€‚ <br>
Actorä¹‹é—´ä¸å…±äº«å†…å­˜ï¼Œåªèƒ½é€šè¿‡å¼‚æ­¥æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚ <br>
å½“Actoræ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä¸‰ç§æ“ä½œï¼šå¤„ç†æ¶ˆæ¯å¹¶æ›´æ–°å†…éƒ¨çŠ¶æ€ã€å‘å…¶ä»–Actorå‘é€æ¶ˆæ¯ã€åˆ›å»ºæ–°çš„Actorã€‚ <br>
è¿™ç§æ¨¡å‹å¤©ç„¶é¿å…äº†ä¼ ç»Ÿå¹¶å‘ç¼–ç¨‹ä¸­çš„é”å’Œç«æ€æ¡ä»¶é—®é¢˜ï¼Œæä¾›äº†æ›´å®‰å…¨çš„å¹¶å‘å¤„ç†æ–¹å¼ã€‚ <br>
Actoræ¨¡å‹ç‰¹åˆ«é€‚åˆæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå› ä¸ºActorå¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œé€šè¿‡ç½‘ç»œè¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„å›´ç»•Actorã€æ¶ˆæ¯é˜Ÿåˆ—å’Œè°ƒåº¦å™¨æ„å»ºã€‚</li>
<li>æ¯ä¸ªActoråŒ…å«é‚®ç®±ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ã€çŠ¶æ€æ•°æ®å’Œæ¶ˆæ¯å¤„ç†é€»è¾‘ã€‚</li>
<li>ç³»ç»Ÿå¯åŠ¨æ—¶åˆ›å»ºå¤šä¸ªWorker Actorå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä¸€ä¸ªAcceptor Actorè´Ÿè´£æ¥å—æ–°è¿æ¥ã€‚</li>
<li>å½“æœ‰æ–°è¿æ¥æ—¶ï¼ŒAcceptorå‘é€æ¶ˆæ¯ç»™è´Ÿè½½æœ€è½»çš„Workerã€‚</li>
<li>Worker Actoræ¥æ”¶åˆ°è¿æ¥æ¶ˆæ¯åï¼Œè´Ÿè´£è¯¥è¿æ¥çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚</li>
<li>Actorè°ƒåº¦å™¨è´Ÿè´£ä»å„ä¸ªActorçš„é‚®ç®±ä¸­å–å‡ºæ¶ˆæ¯å¹¶æ‰§è¡Œç›¸åº”çš„å¤„ç†å‡½æ•°ã€‚</li>
<li>æ¶ˆæ¯ä¼ é€’é€šè¿‡çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—å®ç°ï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹æ¶ˆæ¯ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Actor 1] --&gt;|Message| B[Actor 2]
    A --&gt;|Message| C[Actor 3]
    B --&gt;|Message| A
    C --&gt;|Message| A
    D[Actor System] --&gt; A
    D --&gt; B
    D --&gt; C
    
    E[Message Queue 1] --&gt; A
    F[Message Queue 2] --&gt; B
    G[Message Queue 3] --&gt; C
    
    style A fill:#e1f5fe
    style B fill:#e8f5e8
    style C fill:#fff3e0
    style D fill:#f3e5f5
</code></pre>
<h3 id="15-äº‹ä»¶å¾ªç¯æ¨¡å‹-event-loop">15. äº‹ä»¶å¾ªç¯æ¨¡å‹ (Event Loop)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>event_loop_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ï¼Œç±»ä¼¼Node.jsçš„å®ç°æ–¹å¼</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: I/Oå¯†é›†å‹åº”ç”¨</li>
<li><strong>ä¼˜ç‚¹</strong>: é¿å…çº¿ç¨‹åˆ‡æ¢å¼€é”€ï¼Œå†…å­˜å ç”¨å°‘</li>
<li><strong>ç¼ºç‚¹</strong>: å•çº¿ç¨‹é™åˆ¶ï¼ŒCPUå¯†é›†å‹ä»»åŠ¡ä¼šé˜»å¡</li>
<li><strong>å®ç°</strong>: åŸºäºepoll/kqueue + å›è°ƒå‡½æ•°</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
äº‹ä»¶å¾ªç¯æ¨¡å‹æ˜¯ä¸€ç§å•çº¿ç¨‹å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ï¼Œé€šè¿‡ä¸€ä¸ªæ— é™å¾ªç¯æ¥å¤„ç†æ‰€æœ‰çš„I/Oäº‹ä»¶å’Œå›è°ƒå‡½æ•°ã€‚ <br>
äº‹ä»¶å¾ªç¯ä¸æ–­åœ°æ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ï¼Œå½“æœ‰äº‹ä»¶å°±ç»ªæ—¶æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚ <br>
è¿™ç§æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ‰€æœ‰é˜»å¡æ“ä½œè½¬æ¢ä¸ºéé˜»å¡çš„å¼‚æ­¥æ“ä½œï¼Œé€šè¿‡äº‹ä»¶é€šçŸ¥æœºåˆ¶æ¥å¤„ç†I/Oå®Œæˆã€‚ <br>
äº‹ä»¶å¾ªç¯æ¨¡å‹å¹¿æ³›åº”ç”¨äºNode.jsã€Redisç­‰é«˜æ€§èƒ½æœåŠ¡å™¨ä¸­ï¼Œç‰¹åˆ«é€‚åˆI/Oå¯†é›†å‹åº”ç”¨ã€‚  <br>
ç”±äºé‡‡ç”¨å•çº¿ç¨‹è®¾è®¡ï¼Œé¿å…äº†å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„é”å’ŒåŒæ­¥é—®é¢˜ï¼Œå¤§å¤§ç®€åŒ–äº†ç¼–ç¨‹å¤æ‚åº¦ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„å›´ç»•äº‹ä»¶å¾ªç¯ã€äº‹ä»¶é˜Ÿåˆ—å’Œå›è°ƒå‡½æ•°æ„å»ºã€‚</li>
<li>äº‹ä»¶å¾ªç¯æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£ç›‘å¬æ–‡ä»¶æè¿°ç¬¦ã€å®šæ—¶å™¨å’Œå…¶ä»–äº‹ä»¶æºã€‚</li>
<li>å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œç›¸åº”çš„å›è°ƒå‡½æ•°è¢«æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œäº‹ä»¶å¾ªç¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­å¤„ç†é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å›è°ƒï¼Œç„¶åç­‰å¾…æ–°çš„äº‹ä»¶ã€‚</li>
<li>å¯¹äºç½‘ç»œI/Oï¼Œä½¿ç”¨epoll/kqueueç­‰é«˜æ•ˆçš„I/Oå¤šè·¯å¤ç”¨æœºåˆ¶ã€‚</li>
<li>å®šæ—¶å™¨é€šè¿‡æœ€å°å †å®ç°ï¼Œæ”¯æŒé«˜ç²¾åº¦çš„å®šæ—¶ä»»åŠ¡ã€‚</li>
<li>æ‰€æœ‰çš„I/Oæ“ä½œéƒ½æ˜¯éé˜»å¡çš„ï¼Œå¦‚æœæ“ä½œæ— æ³•ç«‹å³å®Œæˆï¼Œä¼šæ³¨å†Œå›è°ƒå‡½æ•°ç­‰å¾…äº‹ä»¶é€šçŸ¥ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Event Loop] --&gt; B[Event Queue]
    B --&gt; C[Event Handler]
    C --&gt; D[Callback]
    D --&gt; A
    
    E[I/O Events] --&gt; B
    F[Timer Events] --&gt; B
    G[Network Events] --&gt; B
    
    style A fill:#ffecb3
    style B fill:#e3f2fd
    style C fill:#fff3e0
</code></pre>
<h3 id="16-çº¤ç¨‹ç”¨æˆ·æ€çº¿ç¨‹-fibergreen-thread">16. çº¤ç¨‹/ç”¨æˆ·æ€çº¿ç¨‹ (Fiber/Green Thread)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>fiber_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ç”¨æˆ·æ€è°ƒåº¦çš„è½»é‡çº§çº¿ç¨‹</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦å¤§é‡å¹¶å‘è¿æ¥çš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: åˆ›å»ºæˆæœ¬æä½ï¼Œå¯åˆ›å»ºæ•°ä¸‡ä¸ª</li>
<li><strong>ç¼ºç‚¹</strong>: éœ€è¦å®ç°å¤æ‚çš„è°ƒåº¦å™¨å’Œæ ˆç®¡ç†</li>
<li><strong>å®ç°</strong>: éœ€è¦å®ç°ç”¨æˆ·æ€è°ƒåº¦å™¨å’Œæ ˆåˆ‡æ¢</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
çº¤ç¨‹ï¼ˆFiberï¼‰æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œä¹Ÿç§°ä¸ºç»¿è‰²çº¿ç¨‹æˆ–åä½œå¼çº¿ç¨‹ã€‚ <br>
ä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸åŒï¼Œçº¤ç¨‹çš„åˆ›å»ºã€é”€æ¯å’Œè°ƒåº¦éƒ½åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆï¼Œä¸éœ€è¦å†…æ ¸å‚ä¸ã€‚ <br>
çº¤ç¨‹ä¹‹é—´é‡‡ç”¨åä½œå¼è°ƒåº¦ï¼Œåªæœ‰å½“çº¤ç¨‹ä¸»åŠ¨è®©å‡ºæ§åˆ¶æƒæ—¶æ‰ä¼šå‘ç”Ÿåˆ‡æ¢ï¼Œè¿™é¿å…äº†æŠ¢å å¼è°ƒåº¦çš„å¼€é”€å’Œå¤æ‚æ€§ã€‚ <br>
æ¯ä¸ªçº¤ç¨‹åªéœ€è¦å¾ˆå°‘çš„å†…å­˜ï¼ˆé€šå¸¸å‡ KBçš„æ ˆç©ºé—´ï¼‰ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºæ•°åä¸‡ä¸ªçº¤ç¨‹è€Œä¸ä¼šè€—å°½ç³»ç»Ÿèµ„æºã€‚ <br>
çº¤ç¨‹ç‰¹åˆ«é€‚åˆI/Oå¯†é›†å‹åº”ç”¨ï¼Œå½“é‡åˆ°é˜»å¡æ“ä½œæ—¶å¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°å…¶ä»–çº¤ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºç”¨æˆ·æ€è°ƒåº¦å™¨å’Œä¸Šä¸‹æ–‡åˆ‡æ¢æœºåˆ¶æ„å»ºã€‚</li>
<li>æ¯ä¸ªçº¤ç¨‹åŒ…å«ç‹¬ç«‹çš„æ ˆç©ºé—´ã€å¯„å­˜å™¨çŠ¶æ€å’Œæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚</li>
<li>çº¤ç¨‹è°ƒåº¦å™¨ç»´æŠ¤å°±ç»ªé˜Ÿåˆ—å’Œé˜»å¡é˜Ÿåˆ—ï¼Œè´Ÿè´£çº¤ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’Œé”€æ¯ã€‚</li>
<li>å½“çº¤ç¨‹é‡åˆ°I/Oæ“ä½œæ—¶ï¼Œä¼šå°†è‡ªå·±åŠ å…¥é˜»å¡é˜Ÿåˆ—å¹¶yieldç»™è°ƒåº¦å™¨ï¼Œè°ƒåº¦å™¨é€‰æ‹©ä¸‹ä¸€ä¸ªå°±ç»ªçš„çº¤ç¨‹ç»§ç»­æ‰§è¡Œã€‚</li>
<li>I/Oå®Œæˆåï¼Œç›¸åº”çš„çº¤ç¨‹è¢«ç§»å›å°±ç»ªé˜Ÿåˆ—ç­‰å¾…è°ƒåº¦ã€‚</li>
<li>ä¸Šä¸‹æ–‡åˆ‡æ¢é€šè¿‡æ±‡ç¼–ä»£ç å®ç°ï¼Œä¿å­˜å’Œæ¢å¤CPUå¯„å­˜å™¨çŠ¶æ€ã€‚</li>
<li>ä¸ºäº†æ”¯æŒå¼‚æ­¥I/Oï¼Œé€šå¸¸ç»“åˆepollç­‰æœºåˆ¶ï¼Œåœ¨I/Oå°±ç»ªæ—¶å”¤é†’å¯¹åº”çš„çº¤ç¨‹ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[User Thread 1] --&gt; B[Scheduler]
    C[User Thread 2] --&gt; B
    D[User Thread N] --&gt; B
    B --&gt; E[Kernel Thread]
    
    F[Stack 1] --&gt; A
    G[Stack 2] --&gt; C
    H[Stack N] --&gt; D
    
    style A fill:#e8f5e8
    style C fill:#e8f5e8
    style D fill:#e8f5e8
    style B fill:#f3e5f5
</code></pre>
<h3 id="17-å·¥ä½œçªƒå–æ¨¡å‹-work-stealing">17. å·¥ä½œçªƒå–æ¨¡å‹ (Work Stealing)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>work_stealing_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œç©ºé—²æ—¶ä»å…¶ä»–çº¿ç¨‹çªƒå–ä»»åŠ¡</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: CPUå¯†é›†å‹ä»»åŠ¡çš„è´Ÿè½½å‡è¡¡</li>
<li><strong>ä¼˜ç‚¹</strong>: è‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼Œå‡å°‘çº¿ç¨‹ç©ºé—²</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚ï¼Œå¯èƒ½å­˜åœ¨ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</li>
<li><strong>å®ç°</strong>: åŸºäºæ— é”é˜Ÿåˆ—å’Œçº¿ç¨‹æ± </li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
å·¥ä½œçªƒå–æ¨¡å‹æ˜¯ä¸€ç§åŠ¨æ€è´Ÿè½½å‡è¡¡çš„å¹¶è¡Œè®¡ç®—æ¨¡å¼ï¼Œæ¯ä¸ªå·¥ä½œçº¿ç¨‹ç»´æŠ¤è‡ªå·±çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹å®Œæˆè‡ªå·±é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åï¼Œä¼šå°è¯•ä»å…¶ä»–çº¿ç¨‹çš„é˜Ÿåˆ—ä¸­&quot;çªƒå–&quot;ä»»åŠ¡æ¥æ‰§è¡Œã€‚<br>
è¿™ç§æ¨¡å‹èƒ½å¤Ÿè‡ªåŠ¨é€‚åº”ä»»åŠ¡æ‰§è¡Œæ—¶é—´çš„ä¸å‡åŒ€æ€§ï¼Œé¿å…æŸäº›çº¿ç¨‹ç©ºé—²è€Œå…¶ä»–çº¿ç¨‹è¿‡è½½çš„æƒ…å†µã€‚<br>
å·¥ä½œçªƒå–ç®—æ³•æœ€åˆç”±Cilké¡¹ç›®æå‡ºï¼Œåæ¥è¢«å¹¿æ³›åº”ç”¨äºJavaçš„ForkJoinPoolã€Intel TBBç­‰å¹¶è¡Œè®¡ç®—æ¡†æ¶ä¸­ã€‚<br>
è¯¥æ¨¡å‹ç‰¹åˆ«é€‚åˆå¤„ç†é€’å½’åˆ†æ²»ç®—æ³•å’Œä»»åŠ¡æ‰§è¡Œæ—¶é—´å·®å¼‚è¾ƒå¤§çš„åœºæ™¯ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åŸºäºå¤šä¸ªå·¥ä½œçº¿ç¨‹å’ŒåŒç«¯é˜Ÿåˆ—ï¼ˆdequeï¼‰æ„å»ºã€‚</li>
<li>æ¯ä¸ªå·¥ä½œçº¿ç¨‹æ‹¥æœ‰ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œæ–°ä»»åŠ¡ä»é˜Ÿåˆ—å¤´éƒ¨æ·»åŠ ï¼Œçº¿ç¨‹ä»å¤´éƒ¨å–å‡ºä»»åŠ¡æ‰§è¡Œï¼ˆLIFOé¡ºåºï¼Œåˆ©ç”¨ç¼“å­˜å±€éƒ¨æ€§ï¼‰ã€‚</li>
<li>å½“çº¿ç¨‹çš„é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œä¼šéšæœºé€‰æ‹©å…¶ä»–çº¿ç¨‹çš„é˜Ÿåˆ—ï¼Œä»å°¾éƒ¨çªƒå–ä»»åŠ¡ï¼ˆFIFOé¡ºåºï¼Œå‡å°‘å†²çªï¼‰ã€‚</li>
<li>ä¸ºäº†å‡å°‘é”ç«äº‰ï¼Œé€šå¸¸ä½¿ç”¨æ— é”çš„åŒç«¯é˜Ÿåˆ—å®ç°ã€‚</li>
<li>ä»»åŠ¡å¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿæ–°çš„å­ä»»åŠ¡ï¼Œè¿™äº›å­ä»»åŠ¡ä¼šè¢«æ·»åŠ åˆ°å½“å‰çº¿ç¨‹çš„é˜Ÿåˆ—ä¸­ã€‚</li>
<li>ç³»ç»Ÿè¿˜åŒ…å«ä¸€ä¸ªå…¨å±€ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨äºæ¥æ”¶å¤–éƒ¨æäº¤çš„ä»»åŠ¡ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Thread 1] --&gt; B[Task Queue 1]
    C[Thread 2] --&gt; D[Task Queue 2]
    E[Thread N] --&gt; F[Task Queue N]
    
    A --&gt;|Steal| D
    C --&gt;|Steal| F
    E --&gt;|Steal| B
    
    G[Global Task Pool] --&gt; B
    G --&gt; D
    G --&gt; F
    
    style B fill:#e3f2fd
    style D fill:#e3f2fd
    style F fill:#e3f2fd
    style G fill:#ffecb3
</code></pre>
<h3 id="18-ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹">18. ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>producer_consumer_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ä¸“é—¨çš„ç”Ÿäº§è€…çº¿ç¨‹æ¥æ”¶è¿æ¥ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†è¯·æ±‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: æ˜ç¡®åŒºåˆ†æ¥æ”¶å’Œå¤„ç†é€»è¾‘çš„åœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: èŒè´£åˆ†ç¦»ï¼Œæ˜“äºä¼˜åŒ–</li>
<li><strong>ç¼ºç‚¹</strong>: é˜Ÿåˆ—å¯èƒ½æˆä¸ºç“¶é¢ˆ</li>
<li><strong>å®ç°</strong>: åŸºäºçº¿ç¨‹æ±  + é˜»å¡é˜Ÿåˆ—</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹æ˜¯ä¸€ç§ç»å…¸çš„å¹¶å‘è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡ç¼“å†²åŒºå°†æ•°æ®çš„ç”Ÿäº§å’Œæ¶ˆè´¹è¿‡ç¨‹è§£è€¦ã€‚ <br>
ç”Ÿäº§è€…è´Ÿè´£ç”Ÿæˆæ•°æ®å¹¶æ”¾å…¥ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ç¼“å†²åŒºå–å‡ºæ•°æ®è¿›è¡Œå¤„ç†ã€‚ <br>
è¿™ç§æ¨¡å‹ç‰¹åˆ«é€‚åˆå¤„ç†ç”Ÿäº§å’Œæ¶ˆè´¹é€Ÿåº¦ä¸åŒ¹é…çš„åœºæ™¯ï¼Œç¼“å†²åŒºèµ·åˆ°äº†å‰Šå³°å¡«è°·çš„ä½œç”¨ã€‚ <br>
åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸­ï¼Œå¯ä»¥å°†æ¥æ”¶è¿æ¥ä½œä¸ºç”Ÿäº§è¿‡ç¨‹ï¼Œå¤„ç†è¯·æ±‚ä½œä¸ºæ¶ˆè´¹è¿‡ç¨‹ï¼Œé€šè¿‡ä»»åŠ¡é˜Ÿåˆ—è¿›è¡Œè§£è€¦ã€‚<br>
è¿™ç§æ¨¡å‹æé«˜äº†ç³»ç»Ÿçš„ååé‡å’Œå“åº”æ€§ï¼ŒåŒæ—¶ç®€åŒ–äº†ç³»ç»Ÿè®¾è®¡ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„å›´ç»•ç”Ÿäº§è€…çº¿ç¨‹ã€æ¶ˆè´¹è€…çº¿ç¨‹å’Œå…±äº«ç¼“å†²åŒºæ„å»ºã€‚ç¼“å†²åŒºé€šå¸¸ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—å®ç°ï¼Œæ”¯æŒå¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¹¶å‘è®¿é—®ã€‚</li>
<li>ç”Ÿäº§è€…çº¿ç¨‹è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œå°†è¿æ¥ä¿¡æ¯å°è£…æˆä»»åŠ¡å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ã€‚</li>
<li>æ¶ˆè´¹è€…çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡ï¼Œæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>ä¸ºäº†é¿å…ç¼“å†²åŒºæº¢å‡ºæˆ–ç©ºè½¬ï¼Œé€šå¸¸ä½¿ç”¨æ¡ä»¶å˜é‡è¿›è¡ŒåŒæ­¥ï¼šå½“ç¼“å†²åŒºæ»¡æ—¶ç”Ÿäº§è€…ç­‰å¾…ï¼Œå½“ç¼“å†²åŒºç©ºæ—¶æ¶ˆè´¹è€…ç­‰å¾…ã€‚</li>
<li>å¯ä»¥é…ç½®å¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä»¥æé«˜å¹¶å‘æ€§ã€‚ç¼“å†²åŒºå¤§å°éœ€è¦æ ¹æ®ç”Ÿäº§å’Œæ¶ˆè´¹é€Ÿåº¦è¿›è¡Œè°ƒä¼˜ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Producer Thread] --&gt; B[Blocking Queue]
    C[Consumer Thread 1] --&gt; B
    D[Consumer Thread 2] --&gt; B
    E[Consumer Thread N] --&gt; B
    
    F[Client Connections] --&gt; A
    B --&gt; G[Request Processing]
    
    style A fill:#e8f5e8
    style B fill:#ffecb3
    style C fill:#fff3e0
    style D fill:#fff3e0
    style E fill:#fff3e0
</code></pre>
<h3 id="19-åŠåŒæ­¥åŠå¼‚æ­¥æ¨¡å‹-half-synchalf-async">19. åŠåŒæ­¥/åŠå¼‚æ­¥æ¨¡å‹ (Half-Sync/Half-Async)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>half_sync_async_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: åŒæ­¥å±‚å¤„ç†åè®®ï¼Œå¼‚æ­¥å±‚å¤„ç†I/O</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: å¤æ‚åè®®å¤„ç†</li>
<li><strong>ä¼˜ç‚¹</strong>: ç»“åˆåŒæ­¥å’Œå¼‚æ­¥çš„ä¼˜åŠ¿</li>
<li><strong>ç¼ºç‚¹</strong>: æ¶æ„å¤æ‚ï¼Œå±‚é—´é€šä¿¡å¼€é”€</li>
<li><strong>å®ç°</strong>: åˆ†å±‚æ¶æ„ï¼Œå¼‚æ­¥I/O + åŒæ­¥ä¸šåŠ¡é€»è¾‘</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
åŠåŒæ­¥/åŠå¼‚æ­¥æ¨¡å‹æ˜¯ä¸€ç§æ··åˆæ¶æ„æ¨¡å¼ï¼Œå°†ç³»ç»Ÿåˆ†ä¸ºåŒæ­¥å¤„ç†å±‚å’Œå¼‚æ­¥å¤„ç†å±‚ï¼Œç»“åˆä¸¤ç§æ¨¡å¼çš„ä¼˜åŠ¿ã€‚ <br>
å¼‚æ­¥å±‚è´Ÿè´£é«˜æ•ˆçš„I/Oå¤„ç†ï¼Œä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å¤„ç†ç½‘ç»œäº‹ä»¶ï¼›åŒæ­¥å±‚è´Ÿè´£ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„åŒæ­¥ç¼–ç¨‹æ¨¡å‹ã€‚ <br>
ä¸¤å±‚ä¹‹é—´é€šè¿‡é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ï¼Œå¼‚æ­¥å±‚å°†æ¥æ”¶åˆ°çš„è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ï¼ŒåŒæ­¥å±‚çš„å·¥ä½œçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºè¯·æ±‚è¿›è¡Œå¤„ç†ã€‚ <br>
è¿™ç§æ¨¡å‹æ—¢ä¿è¯äº†I/Oå¤„ç†çš„é«˜æ•ˆæ€§ï¼Œåˆä¿æŒäº†ä¸šåŠ¡é€»è¾‘çš„ç®€æ´æ€§ï¼Œæ˜¯å®é™…é¡¹ç›®ä¸­å¸¸ç”¨çš„æ¶æ„æ¨¡å¼ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„åˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼šå¼‚æ­¥I/Oå±‚ã€åŒæ­¥å¤„ç†å±‚å’Œé˜Ÿåˆ—å±‚ã€‚</li>
<li>å¼‚æ­¥I/Oå±‚ä½¿ç”¨å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ï¼ŒåŸºäºepoll/kqueueç­‰æœºåˆ¶å¤„ç†æ‰€æœ‰çš„ç½‘ç»œI/Oäº‹ä»¶ï¼ŒåŒ…æ‹¬æ¥å—è¿æ¥ã€è¯»å–æ•°æ®ã€å‘é€å“åº”ã€‚</li>
<li>å½“å®Œæ•´çš„è¯·æ±‚æ¥æ”¶å®Œæˆåï¼Œå°†è¯·æ±‚æ•°æ®å°è£…æˆä»»åŠ¡å¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ã€‚</li>
<li>åŒæ­¥å¤„ç†å±‚åŒ…å«å¤šä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„åŒæ­¥æ–¹å¼å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ•°æ®åº“è®¿é—®ã€æ–‡ä»¶æ“ä½œç­‰ã€‚</li>
<li>å¤„ç†å®Œæˆåï¼Œå°†å“åº”æ•°æ®é€šè¿‡é˜Ÿåˆ—ä¼ å›å¼‚æ­¥å±‚è¿›è¡Œå‘é€ã€‚</li>
<li>é˜Ÿåˆ—å±‚è´Ÿè´£ä¸¤å±‚ä¹‹é—´çš„é€šä¿¡ï¼Œé€šå¸¸ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—å®ç°ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Client] --&gt; B[Synchronous Layer]
    B --&gt; C[Queue]
    C --&gt; D[Asynchronous Layer]
    D --&gt; E[I/O Operations]
    E --&gt; D
    D --&gt; C
    C --&gt; B
    B --&gt; A
    
    style B fill:#e1f5fe
    style C fill:#ffecb3
    style D fill:#e8f5e8
</code></pre>
<h3 id="20-proactoræ¨¡å¼">20. Proactoræ¨¡å¼</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>proactor_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: å¼‚æ­¥I/Oå®Œæˆåé€šçŸ¥åº”ç”¨ç¨‹åº</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: Windows IOCPï¼Œå¼‚æ­¥I/Oåœºæ™¯</li>
<li><strong>ä¼˜ç‚¹</strong>: çœŸæ­£çš„å¼‚æ­¥I/O</li>
<li><strong>ç¼ºç‚¹</strong>: å¹³å°ä¾èµ–æ€§å¼ºï¼Œå®ç°å¤æ‚</li>
<li><strong>å®ç°</strong>: åŸºäºæ“ä½œç³»ç»Ÿçš„å¼‚æ­¥I/Oæœºåˆ¶</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
Proactoræ¨¡å¼æ˜¯ä¸€ç§åŸºäºå¼‚æ­¥I/Oçš„è®¾è®¡æ¨¡å¼ï¼Œä¸Reactoræ¨¡å¼ç›¸å¯¹åº”ã€‚ <br>
åœ¨Reactoræ¨¡å¼ä¸­ï¼Œåº”ç”¨ç¨‹åºåœ¨I/Oå°±ç»ªæ—¶è¢«é€šçŸ¥å¹¶è‡ªå·±æ‰§è¡ŒI/Oæ“ä½œï¼Œè€Œåœ¨Proactoræ¨¡å¼ä¸­ï¼Œåº”ç”¨ç¨‹åºå‘èµ·å¼‚æ­¥I/Oæ“ä½œï¼Œæ“ä½œç³»ç»Ÿå®ŒæˆI/Oåé€šçŸ¥åº”ç”¨ç¨‹åºå¤„ç†ç»“æœã€‚<br>
è¿™ç§æ¨¡å¼çœŸæ­£å®ç°äº†I/Oæ“ä½œçš„å¼‚æ­¥åŒ–ï¼Œåº”ç”¨ç¨‹åºæ— éœ€é˜»å¡ç­‰å¾…I/Oå®Œæˆï¼Œå¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚<br>
Proactoræ¨¡å¼ç‰¹åˆ«é€‚åˆI/Oå¯†é›†å‹åº”ç”¨ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œæä¾›æ›´é«˜çš„å¹¶å‘æ€§èƒ½ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„å›´ç»•å¼‚æ­¥I/Oæ“ä½œå’Œå®Œæˆé€šçŸ¥æ„å»ºã€‚</li>
<li>æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼šProactorè´Ÿè´£ç®¡ç†å¼‚æ­¥æ“ä½œå’Œåˆ†å‘å®Œæˆäº‹ä»¶ï¼ŒAsynchronousOperationProcessorå¤„ç†å¼‚æ­¥I/Oæ“ä½œï¼ŒCompletionHandlerå¤„ç†I/Oå®Œæˆäº‹ä»¶ã€‚</li>
<li>åº”ç”¨ç¨‹åºå‘èµ·å¼‚æ­¥è¯»å†™æ“ä½œæ—¶ï¼Œå°†æ“ä½œæäº¤ç»™æ“ä½œç³»ç»Ÿï¼ŒåŒæ—¶æ³¨å†Œå®Œæˆå¤„ç†å™¨ã€‚æ“ä½œç³»ç»Ÿåœ¨åå°æ‰§è¡ŒI/Oæ“ä½œï¼Œå®Œæˆåå°†ç»“æœæ”¾å…¥å®Œæˆé˜Ÿåˆ—ã€‚</li>
<li>Proactorä»å®Œæˆé˜Ÿåˆ—ä¸­å–å‡ºäº‹ä»¶ï¼Œè°ƒç”¨ç›¸åº”çš„å®Œæˆå¤„ç†å™¨ã€‚</li>
<li>åœ¨Windowsä¸Šå¯ä»¥ä½¿ç”¨IOCPï¼ˆI/O Completion Portsï¼‰ï¼Œåœ¨Linuxä¸Šå¯ä»¥ä½¿ç”¨io_uringæˆ–æ¨¡æ‹Ÿå®ç°ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Initiator] --&gt; B[Asynchronous Operation]
    B --&gt; C[OS Kernel]
    C --&gt; D[Completion Handler]
    D --&gt; A
    
    E[Application] --&gt; A
    F[I/O Completion Port] --&gt; D
    
    style A fill:#fff3e0
    style B fill:#e3f2fd
    style C fill:#f3e5f5
    style D fill:#e8f5e8
</code></pre>
<h3 id="21-ç®¡é“æ¨¡å‹-pipeline">21. ç®¡é“æ¨¡å‹ (Pipeline)</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>pipeline_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: è¯·æ±‚å¤„ç†åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µç”±ä¸åŒçº¿ç¨‹å¤„ç†</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: å¤æ‚çš„è¯·æ±‚å¤„ç†æµç¨‹</li>
<li><strong>ä¼˜ç‚¹</strong>: æµæ°´çº¿å¤„ç†ï¼Œæé«˜ååé‡</li>
<li><strong>ç¼ºç‚¹</strong>: é˜¶æ®µé—´åŒæ­¥å¤æ‚ï¼Œå¯èƒ½å­˜åœ¨ç“¶é¢ˆé˜¶æ®µ</li>
<li><strong>å®ç°</strong>: å¤šä¸ªçº¿ç¨‹æ± ï¼Œæ¯ä¸ªå¤„ç†ä¸€ä¸ªé˜¶æ®µ</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
ç®¡é“æ¨¡å‹å°†è¯·æ±‚å¤„ç†è¿‡ç¨‹åˆ†è§£ä¸ºå¤šä¸ªè¿ç»­çš„é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µç”±ä¸“é—¨çš„çº¿ç¨‹æˆ–çº¿ç¨‹æ± è´Ÿè´£ï¼Œå½¢æˆæµæ°´çº¿å¼çš„å¤„ç†æ¶æ„ã€‚ <br>
è¯·æ±‚æŒ‰é¡ºåºé€šè¿‡å„ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µä¸“æ³¨äºç‰¹å®šçš„å¤„ç†ä»»åŠ¡ï¼Œå¦‚è§£æã€éªŒè¯ã€ä¸šåŠ¡é€»è¾‘ã€å“åº”ç”Ÿæˆç­‰ã€‚
è¿™ç§æ¨¡å‹ç±»ä¼¼äºå·¥å‚çš„æµæ°´çº¿ç”Ÿäº§ï¼Œèƒ½å¤Ÿæ˜¾è‘—æé«˜ç³»ç»Ÿçš„ååé‡ï¼Œå› ä¸ºå¤šä¸ªè¯·æ±‚å¯ä»¥åŒæ—¶åœ¨ä¸åŒé˜¶æ®µå¹¶è¡Œå¤„ç†ã€‚ <br>
ç®¡é“æ¨¡å‹ç‰¹åˆ«é€‚åˆå¤„ç†æ­¥éª¤å›ºå®šã€å¯ä»¥åˆ†è§£çš„å¤æ‚ä¸šåŠ¡æµç¨‹ï¼Œåœ¨æ•°æ®å¤„ç†ã€å›¾åƒå¤„ç†ã€ç¼–è¯‘å™¨ç­‰é¢†åŸŸåº”ç”¨å¹¿æ³›ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„ç”±å¤šä¸ªå¤„ç†é˜¶æ®µå’Œé˜¶æ®µé—´çš„ç¼“å†²é˜Ÿåˆ—ç»„æˆï¼Œæ¯ä¸ªé˜¶æ®µåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä¸“é—¨è´Ÿè´£ç‰¹å®šçš„å¤„ç†ä»»åŠ¡ã€‚</li>
<li>é˜¶æ®µä¹‹é—´é€šè¿‡çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—è¿æ¥ï¼Œå‰ä¸€é˜¶æ®µçš„è¾“å‡ºä½œä¸ºåä¸€é˜¶æ®µçš„è¾“å…¥ã€‚</li>
<li>è¯·æ±‚ä»ç¬¬ä¸€ä¸ªé˜¶æ®µå¼€å§‹ï¼Œä¾æ¬¡é€šè¿‡æ‰€æœ‰é˜¶æ®µï¼Œæœ€ç»ˆäº§ç”Ÿå“åº”ã€‚</li>
<li>æ¯ä¸ªé˜¶æ®µå¯ä»¥ç‹¬ç«‹è°ƒä¼˜ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ•°é‡ã€é˜Ÿåˆ—å¤§å°ç­‰å‚æ•°ã€‚</li>
<li>ä¸ºäº†é¿å…æŸä¸ªé˜¶æ®µæˆä¸ºç“¶é¢ˆï¼Œéœ€è¦æ ¹æ®å„é˜¶æ®µçš„å¤„ç†èƒ½åŠ›åˆç†é…ç½®èµ„æºã€‚</li>
<li>å¯ä»¥å®ç°é˜¶æ®µçš„åŠ¨æ€æ‰©ç¼©å®¹ï¼Œæ ¹æ®è´Ÿè½½æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡ã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Request] --&gt; B[Stage 1 Thread Pool]
    B --&gt; C[Stage 2 Thread Pool]
    C --&gt; D[Stage 3 Thread Pool]
    D --&gt; E[Stage N Thread Pool]
    E --&gt; F[Response]
    
    G[Buffer 1] --&gt; B
    H[Buffer 2] --&gt; C
    I[Buffer 3] --&gt; D
    J[Buffer N] --&gt; E
    
    style B fill:#e1f5fe
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#f3e5f5
</code></pre>
<h3 id="22-æ··åˆæ¨¡å‹">22. æ··åˆæ¨¡å‹</h3>
<ul>
<li><strong>æ–‡ä»¶</strong>: <code>hybrid_server.h</code></li>
<li><strong>ç‰¹ç‚¹</strong>: ç»“åˆå¤šç§æ¨¡å‹çš„ä¼˜åŠ¿</li>
<li><strong>ç¤ºä¾‹</strong>:
<ul>
<li>Reactor + çº¿ç¨‹æ± </li>
<li>Epoll + åç¨‹</li>
<li>å¤šè¿›ç¨‹ + å¤šçº¿ç¨‹</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦å¹³è¡¡å„ç§æ€§èƒ½æŒ‡æ ‡</li>
<li><strong>ä¼˜ç‚¹</strong>: çµæ´»æ€§é«˜ï¼Œå¯é’ˆå¯¹æ€§ä¼˜åŒ–</li>
<li><strong>ç¼ºç‚¹</strong>: å®ç°å¤æ‚ï¼Œè°ƒè¯•å›°éš¾</li>
</ul>
<p><strong>è¯¦ç»†ä»‹ç»</strong>ï¼š
æ··åˆæ¨¡å‹æ˜¯ä¸€ç§ç»¼åˆæ€§çš„å¹¶å‘æ¶æ„ï¼Œæ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚å’Œæ€§èƒ½è¦æ±‚ï¼Œåœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­ç»„åˆä½¿ç”¨å¤šç§å¹¶å‘æ¨¡å‹ï¼Œå¯ä»¥åœ¨I/Oå¤„ç†å±‚ä½¿ç”¨Reactoræ¨¡å‹å®ç°é«˜æ•ˆçš„äº‹ä»¶å¤„ç†ï¼Œåœ¨ä¸šåŠ¡é€»è¾‘å±‚ä½¿ç”¨çº¿ç¨‹æ± æ¨¡å‹ä¿è¯å¤„ç†èƒ½åŠ›ï¼Œåœ¨æ•°æ®è®¿é—®å±‚ä½¿ç”¨å¼‚æ­¥I/Oæ¨¡å‹æé«˜æ•°æ®åº“è®¿é—®æ•ˆç‡ã€‚ <br>
è¿™ç§æ¨¡å‹å…è®¸å¼€å‘è€…é’ˆå¯¹ç³»ç»Ÿçš„ä¸åŒéƒ¨åˆ†é€‰æ‹©æœ€é€‚åˆçš„å¹¶å‘ç­–ç•¥ï¼Œä»è€Œåœ¨æ•´ä½“ä¸Šè¾¾åˆ°æœ€ä¼˜çš„æ€§èƒ½è¡¨ç°ã€‚<br>
æ··åˆæ¨¡å‹åœ¨å¤§å‹ä¼ä¸šçº§åº”ç”¨ã€å¾®æœåŠ¡æ¶æ„ã€åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åº”ç”¨å¹¿æ³›ï¼Œæ˜¯ç°ä»£é«˜æ€§èƒ½æœåŠ¡å™¨çš„ä¸»æµæ¶æ„é€‰æ‹©ã€‚</p>
<p><strong>å®ç°æ¶æ„</strong>ï¼š</p>
<ul>
<li>æ¶æ„é‡‡ç”¨åˆ†å±‚è®¾è®¡ï¼Œæ¯å±‚æ ¹æ®å…¶ç‰¹ç‚¹é€‰æ‹©æœ€é€‚åˆçš„å¹¶å‘æ¨¡å‹ã€‚</li>
<li>ç½‘ç»œæ¥å…¥å±‚é€šå¸¸ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼ˆå¦‚Epoll/Reactorï¼‰å¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼Œä¿è¯é«˜æ•ˆçš„I/Oå¤„ç†ã€‚</li>
<li>è¯·æ±‚è·¯ç”±å±‚å¯èƒ½ä½¿ç”¨Actoræ¨¡å‹å®ç°è¯·æ±‚çš„åˆ†å‘å’Œè´Ÿè½½å‡è¡¡ã€‚</li>
<li>ä¸šåŠ¡å¤„ç†å±‚æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Œå¦‚CPUå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨çº¿ç¨‹æ± ï¼ŒI/Oå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨å¼‚æ­¥æ¨¡å‹ã€‚</li>
<li>æ•°æ®è®¿é—®å±‚å¯èƒ½ç»“åˆè¿æ¥æ± å’Œå¼‚æ­¥I/Oæ¥ä¼˜åŒ–æ•°æ®åº“è®¿é—®ã€‚</li>
<li>å„å±‚ä¹‹é—´é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ã€äº‹ä»¶æ€»çº¿æˆ–ç›´æ¥è°ƒç”¨è¿›è¡Œé€šä¿¡ã€‚</li>
<li>ç³»ç»Ÿéœ€è¦ç»Ÿä¸€çš„ç›‘æ§å’Œç®¡ç†æœºåˆ¶æ¥åè°ƒå„ä¸ªæ¨¡å‹çš„è¿è¡Œã€‚</li>
</ul>
<pre><code class="language-mermaid">flowchart TD
    A[Model A] --&gt; B[Hybrid Controller]
    C[Model B] --&gt; B
    D[Model C] --&gt; B
    B --&gt; E[Unified Interface]
    
    F[Load Balancer] --&gt; A
    F --&gt; C
    F --&gt; D
    
    style A fill:#e8f5e8
    style C fill:#fff3e0
    style D fill:#e1f5fe
    style B fill:#f3e5f5
</code></pre>
<h2 id="ç¼–è¯‘å’Œè¿è¡Œ">ç¼–è¯‘å’Œè¿è¡Œ</h2>
<h3 id="ç¼–è¯‘">ç¼–è¯‘</h3>
<pre><code class="language-bash">make
</code></pre>
<h3 id="è¿è¡ŒæœåŠ¡å™¨">è¿è¡ŒæœåŠ¡å™¨</h3>
<pre><code class="language-bash"># åŸºæœ¬ç”¨æ³•
./concurrency_server &lt;model&gt; [port]

# ç¤ºä¾‹
./concurrency_server thread_pool 8080
./concurrency_server epoll 9000
./concurrency_server reactor 8888
</code></pre>
<h3 id="æµ‹è¯•ç‰¹å®šæ¨¡å‹">æµ‹è¯•ç‰¹å®šæ¨¡å‹</h3>
<pre><code class="language-bash"># æµ‹è¯•çº¿ç¨‹æ± æ¨¡å‹
make test-thread-pool

# æµ‹è¯•epollæ¨¡å‹
make test-epoll

# æµ‹è¯•æ‰€æœ‰æ¨¡å‹ï¼ˆéœ€è¦æ‰‹åŠ¨åœæ­¢ï¼‰
make test-single
make test-multi-thread
# ... ç­‰ç­‰
</code></pre>
<h3 id="æ€§èƒ½æµ‹è¯•">æ€§èƒ½æµ‹è¯•</h3>
<pre><code class="language-bash"># éœ€è¦å®‰è£…Apache Bench (ab)
make bench
</code></pre>
<h2 id="å®¢æˆ·ç«¯æµ‹è¯•">å®¢æˆ·ç«¯æµ‹è¯•</h2>
<p>å¯ä»¥ä½¿ç”¨å¤šç§å·¥å…·æµ‹è¯•æœåŠ¡å™¨ï¼š</p>
<h3 id="ä½¿ç”¨curl">ä½¿ç”¨curl</h3>
<pre><code class="language-bash">curl http://localhost:8080/
</code></pre>
<h3 id="ä½¿ç”¨apache-bench">ä½¿ç”¨Apache Bench</h3>
<pre><code class="language-bash"># 1000ä¸ªè¯·æ±‚ï¼Œ10ä¸ªå¹¶å‘è¿æ¥
ab -n 1000 -c 10 http://localhost:8080/
</code></pre>
<h3 id="ä½¿ç”¨telnet">ä½¿ç”¨telnet</h3>
<pre><code class="language-bash">telnet localhost 8080
GET / HTTP/1.1
Host: localhost

</code></pre>
<h2 id="æ€§èƒ½å¯¹æ¯”">æ€§èƒ½å¯¹æ¯”</h2>
<table>
  <thead>
      <tr>
          <th>æ¨¡å‹åç§°</th>
          <th style="text-align: right">QPS</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>single_process</td>
          <td style="text-align: right">19075.400</td>
      </tr>
      <tr>
          <td>multi_process</td>
          <td style="text-align: right">6904.800</td>
      </tr>
      <tr>
          <td>multi_thread</td>
          <td style="text-align: right">18137.834</td>
      </tr>
      <tr>
          <td>process_pool1</td>
          <td style="text-align: right">18337.299</td>
      </tr>
      <tr>
          <td>process_pool2</td>
          <td style="text-align: right">18589.268</td>
      </tr>
      <tr>
          <td>thread_pool</td>
          <td style="text-align: right">18483.166</td>
      </tr>
      <tr>
          <td>leader_follower</td>
          <td style="text-align: right">20180.701</td>
      </tr>
      <tr>
          <td>poll</td>
          <td style="text-align: right">18817.867</td>
      </tr>
      <tr>
          <td>kqueue</td>
          <td style="text-align: right">19096.133</td>
      </tr>
      <tr>
          <td>reactor</td>
          <td style="text-align: right">18945.467</td>
      </tr>
      <tr>
          <td>event_loop</td>
          <td style="text-align: right">19442.801</td>
      </tr>
      <tr>
          <td>work_stealing</td>
          <td style="text-align: right">8903.566</td>
      </tr>
      <tr>
          <td>actor</td>
          <td style="text-align: right">18681.500</td>
      </tr>
      <tr>
          <td>fiber</td>
          <td style="text-align: right">18994.268</td>
      </tr>
      <tr>
          <td>producer_consumer</td>
          <td style="text-align: right">18208.633</td>
      </tr>
      <tr>
          <td>proactor</td>
          <td style="text-align: right">18130.533</td>
      </tr>
  </tbody>
</table>
<h2 id="æŠ€æœ¯è¦ç‚¹">æŠ€æœ¯è¦ç‚¹</h2>
<h3 id="1-éé˜»å¡io">1. éé˜»å¡I/O</h3>
<p>å¤§éƒ¨åˆ†æ¨¡å‹éƒ½ä½¿ç”¨äº†éé˜»å¡I/Oæ¥æé«˜æ€§èƒ½ï¼š</p>
<pre><code class="language-cpp">bool set_nonblocking(int fd) {
    int flags = fcntl(fd, F_GETFL, 0);
    if (flags == -1) return false;
    return fcntl(fd, F_SETFL, flags | O_NONBLOCK) != -1;
}
</code></pre>
<h3 id="2-ä¿¡å·å¤„ç†">2. ä¿¡å·å¤„ç†</h3>
<p>è¿›ç¨‹æ¨¡å‹éœ€è¦å¤„ç†SIGCHLDä¿¡å·é¿å…åƒµå°¸è¿›ç¨‹ï¼š</p>
<pre><code class="language-cpp">signal(SIGCHLD, SIG_IGN);
</code></pre>
<h3 id="3-å¥—æ¥å­—é€‰é¡¹">3. å¥—æ¥å­—é€‰é¡¹</h3>
<p>ä½¿ç”¨SO_REUSEADDRé¿å…åœ°å€é‡ç”¨é—®é¢˜ï¼š</p>
<pre><code class="language-cpp">int opt = 1;
setsockopt(server_fd, SOL_SOCKET, SO_REUSEADDR, &amp;opt, sizeof(opt));
</code></pre>
<h3 id="4-è¾¹ç¼˜è§¦å‘-vs-æ°´å¹³è§¦å‘">4. è¾¹ç¼˜è§¦å‘ vs æ°´å¹³è§¦å‘</h3>
<ul>
<li><strong>æ°´å¹³è§¦å‘</strong>: åªè¦æ¡ä»¶æ»¡è¶³å°±ä¼šè§¦å‘äº‹ä»¶</li>
<li><strong>è¾¹ç¼˜è§¦å‘</strong>: åªåœ¨çŠ¶æ€å˜åŒ–æ—¶è§¦å‘äº‹ä»¶</li>
</ul>
<h2 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>å¹³å°å…¼å®¹æ€§</strong>: Epollä»…åœ¨Linuxä¸Šå¯ç”¨ï¼ŒKqueueä»…åœ¨BSD/macOSä¸Šå¯ç”¨</li>
<li><strong>èµ„æºé™åˆ¶</strong>: æ³¨æ„ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶å’Œå†…å­˜é™åˆ¶</li>
<li><strong>ä¿¡å·å¤„ç†</strong>: å¤šè¿›ç¨‹æ¨¡å‹éœ€è¦æ­£ç¡®å¤„ç†å­è¿›ç¨‹ä¿¡å·</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>: å¤šçº¿ç¨‹æ¨¡å‹éœ€è¦æ³¨æ„å…±äº«èµ„æºçš„åŒæ­¥</li>
<li><strong>é”™è¯¯å¤„ç†</strong>: ç½‘ç»œç¼–ç¨‹ä¸­è¦å……åˆ†è€ƒè™‘å„ç§é”™è¯¯æƒ…å†µ</li>
</ol>
<h2 id="æ‰©å±•å»ºè®®">æ‰©å±•å»ºè®®</h2>
<ol>
<li><strong>SSL/TLSæ”¯æŒ</strong>: æ·»åŠ HTTPSæ”¯æŒ</li>
<li><strong>HTTPè§£æ</strong>: å®Œæ•´çš„HTTPåè®®è§£æ</li>
<li><strong>é…ç½®æ–‡ä»¶</strong>: æ”¯æŒé…ç½®æ–‡ä»¶è®¾ç½®å‚æ•°</li>
<li><strong>æ—¥å¿—ç³»ç»Ÿ</strong>: æ·»åŠ å®Œæ•´çš„æ—¥å¿—è®°å½•</li>
<li><strong>ç›‘æ§æŒ‡æ ‡</strong>: æ·»åŠ æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>: å®ç°å¤šæœåŠ¡å™¨è´Ÿè½½å‡è¡¡</li>
</ol>
<h2 id="å­¦ä¹ èµ„æº">å­¦ä¹ èµ„æº</h2>
<ul>
<li>ã€ŠUnixç½‘ç»œç¼–ç¨‹ã€‹- W. Richard Stevens</li>
<li>ã€ŠLinuxé«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹ã€‹- æ¸¸åŒ</li>
<li>ã€ŠC++å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹- Anthony Williams</li>
<li>ã€Šé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ã€‹ç›¸å…³èµ„æ–™</li>
</ul>
<h2 id="è®¸å¯è¯">è®¸å¯è¯</h2>
<p>æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚</p>

</main>

<style>
    

    

    body {
        margin-right: 280px;
    }

    @media (max-width: 768px) {
        body {
            margin-right: 0;
        }
    }

    

     
    .article-meta {
        text-align: center;
        text-decoration: none;
        background: #efefef;
        padding: 1px;
        border-radius: 5px;
    }

    .article-meta-title {
        font-size: 2.2rem;
    }

    .article-meta-info {
        color: #666;
        font-size: 1.1rem;
        margin: -0.6rem 0 0.2rem 10px;
        text-align: left;
    }

    .article-meta-info a {
        color: inherit;
        text-decoration: none;
        transition: color 0.3s ease;
    }
</style>



<h1 style="font-size: 1.2rem; margin: 2.5rem 0 0.1rem 0;">Comment</h1>
<div class="cusdis-comments">
  <div id="cusdis_thread"
    data-host="https://cusdis.com"
    data-app-id=697d528d-b618-4ee1-a6fe-403c81a646ac
    data-page-id="acf9ee13a5370db0273c79a1c3e4793e"
    data-page-url="https://kaikaixixi.xyz/%E8%BD%AC%E8%BD%BD/2025/06/10/22%E7%A7%8Dc-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B/"
    data-page-title="C&#43;&#43; é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç° | [è½¬è½½](https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md)"
  ></div>
  <script async defer src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/cusdis/cusdis.es.min.js"></script>
</div>

<style>
.cusdis-comments {
  border-top: 2px dashed #cfcfcf;
  padding-top: 1.3rem;
}

#cusdis_thread iframe {
  min-height: 500px !important;
  overflow: visible !important;
}
</style>


<footer>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/js/auto-render.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/js/math-code.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/js/render-katex.min.js"></script>

  <script src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/js/center-img.min.js"></script>

  

<div id="menuBtnContainer">
    
    <button id="menuBtn"><i class="fa-solid fa-screwdriver-wrench"></i></button>

    
    <button id="backToBottomBtn" class="menu-popup-btn top-btn"><i class="fa-solid fa-square-caret-down"></i></button>
    <button id="backToTopBtn" class="menu-popup-btn top-btn"><i class="fa-solid fa-square-caret-up"></i></button>

    
    <div class="menu-popup-btn edit-btn">
        <a href='https://github.com/captainwc/captainwc.github.io/edit/main/content/%e7%bd%91%e9%a1%b5%e5%89%aa%e8%97%8f/22%e7%a7%8dC&#43;&#43;%e7%bd%91%e7%bb%9c%e7%bc%96%e7%a8%8b%e5%b9%b6%e5%8f%91%e6%a8%a1%e5%9e%8b.md'
            target="_blank" rel="noopener">
            <i class="fa-solid fa-square-pen"></i>
        </a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var menuBtn = document.getElementById('menuBtn');
        var menuBtnContainer = document.getElementById('menuBtnContainer');
        var backToTopBtn = document.getElementById('backToTopBtn');
        var backToBottomBtn = document.getElementById('backToBottomBtn');
        var popupBtns = document.querySelectorAll('.menu-popup-btn');
        var hoverTimeout;

        
        menuBtnContainer.classList.add('visible');

        
        function showPopupBtns() {
            clearTimeout(hoverTimeout);
            menuBtnContainer.classList.add('active');
        }

        
        function hidePopupBtns() {
            hoverTimeout = setTimeout(function() {
                menuBtnContainer.classList.remove('active');
            }, 300);
        }

        
        menuBtnContainer.addEventListener('mouseenter', showPopupBtns);
        menuBtnContainer.addEventListener('mouseleave', hidePopupBtns);

        
        menuBtn.addEventListener('click', function() {
            if (menuBtnContainer.classList.contains('active')) {
                menuBtnContainer.classList.remove('active');
            } else {
                showPopupBtns();
            }
        });

        
        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        
        backToBottomBtn.addEventListener('click', function() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        });
    });
</script>

<style>
     
    #menuBtnContainer {
        position: fixed;
        right: 20px;
        bottom: 20px;
        z-index: 999;
        opacity: 0.6;
        visibility: visible;
        transition: opacity 0.3s;
    }

    #menuBtnContainer:hover {
        opacity: 1;
    }

     
    #menuBtn {
        border-radius: 8px;
        border: none;
        color: #aaa;
        font-family: "Maple Mono NF CN";
        font-size: 1.2rem;
        transition: background 0.3s;
        cursor: pointer;
        background: #EFEFEF;
        z-index: 1000;
        position: relative;
    }

    #menuBtn:hover {
        background: #BEC2B3;
        color: #666;
    }

     
    .menu-popup-btn {
        position: absolute;
        opacity: 0;
        visibility: hidden;
        border-radius: 8px;
        border: none;
        color: #aaa;
        font-family: "Maple Mono NF CN";
        font-size: 1.3rem;
        transition: all 0.3s ease;
        background: #EFEFEF;
        cursor: pointer;
        z-index: 999;
    }

     
    .menu-popup-btn.top-btn {
        right: 0;
        transform: translateY(0) scale(0.8);
    }

     
    .menu-popup-btn.edit-btn {
        bottom: 0;
        transform: translateX(0) scale(0.8);
        padding: 1px 6.6px 0px 6.6px;
    }

    .menu-popup-btn.edit-btn a {
        color: #ccc;
        text-decoration: none;
        background: none !important;
        transition: opacity 0.2s;
        padding: 0;
        margin: 0;
    }

     
    #menuBtnContainer.active .menu-popup-btn {
        opacity: 1;
        visibility: visible;
    }

     
    #menuBtnContainer.active #backToBottomBtn {
        transform: translateY(-60px) scale(1);
    }

     
    #menuBtnContainer.active #backToTopBtn {
        transform: translateY(-110px) scale(1);
    }

     
    #menuBtnContainer.active .edit-btn {
        transform: translateX(-60px) scale(1);
    }

     
    .menu-popup-btn:hover,
    .menu-popup-btn.edit-btn:hover {
        background: #BEC2B3;
        color: #666;
    }

    .menu-popup-btn.edit-btn:hover a {
        color: #666;
    }

     
    @media (max-width: 768px) {
        #menuBtnContainer {
            right: 15px;
            bottom: 15px;
        }

        #menuBtnContainer.active #backToBottomBtn {
            transform: translateY(-50px) scale(1);
        }

        #menuBtnContainer.active #backToTopBtn {
            transform: translateY(-90px) scale(1);
        }

        #menuBtnContainer.active .edit-btn {
            transform: translateX(-50px) scale(1);
        }
    }
</style>



  <script>
  document.addEventListener('DOMContentLoaded', function() {
    
    document.querySelectorAll('ul').forEach(ul => {
      
      const isTodoList = Array.from(ul.children).some(li => {
        return li.innerHTML.includes('type="checkbox"')
      });

      if (isTodoList) {
        
        const todolistContainer = document.createElement('div');
        todolistContainer.className = 'todolist';

        

        
        ul.querySelectorAll('li').forEach(li => {
          const todoItemDiv = document.createElement('div');
          todoItemDiv.className = 'todo-item';

          
          const isChecked = li.innerHTML.includes('checked');
          const content = li.innerHTML
            .replace(/<input[^>]+>/g, '') 
            .trim();

          
          const checkedIcon = `<svg t="1742522457277" class="todo-item-checked-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12342"><path d="M512 938.688A426.624 426.624 0 1 1 512 85.376a426.624 426.624 0 0 1 0 853.312z m0-85.312A341.312 341.312 0 1 0 512 170.688a341.312 341.312 0 0 0 0 682.688z m-42.56-170.688L288.448 501.632l60.288-60.288L469.44 561.92l241.28-241.28 60.416 60.288-301.696 301.696z" p-id="12343"></path></svg>`;
          const uncheckedIcon = `<svg t="1742522354856" class="todo-item-unchecked-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11882"><path d="M512 938.666667C276.352 938.666667 85.333333 747.648 85.333333 512S276.352 85.333333 512 85.333333s426.666667 191.018667 426.666667 426.666667-191.018667 426.666667-426.666667 426.666667z m0-85.333334a341.333333 341.333333 0 1 0 0-682.709333A341.333333 341.333333 0 0 0 512 853.333333z" p-id="11883"></path></svg>`;

          
          todoItemDiv.innerHTML = `
            <span class="todo-item-checkbox">
              ${isChecked ? checkedIcon : uncheckedIcon}
            </span>
            <span class="todo-item-content">
              ${isChecked ? `<del>${content}</del>` : content}
            </span>
          `;

          
          todolistContainer.appendChild(todoItemDiv);
        });

        
        ul.parentNode.replaceChild(todolistContainer, ul);
      }
    });

    function addTaskProgressBar(ul, todolistContainer) {
      
      const totalTasks = ul.children.length;
      const finishedTasks = Array.from(ul.children).filter(li => li.innerHTML.includes('checked')).length;

      
      const progressContainer = document.createElement('div');
      progressContainer.className = 'todo-progress';

      
      const counterSpan = document.createElement('span');
      counterSpan.className = 'todo-progress-counter';
      counterSpan.textContent = `${finishedTasks}/${totalTasks}`;

      
      const progressTrack = document.createElement('div');
      progressTrack.className = 'todo-progress-bar';

      
      const progressFill = document.createElement('div');
      progressFill.className = 'todo-progress-bar-fill';
      progressFill.style.width = `${(finishedTasks / totalTasks) * 100}%`;

      
      const flagSpan = document.createElement('span');
      flagSpan.className = 'todo-progress-flag';
      flagSpan.innerHTML = `${finishedTasks === totalTasks ? 'ğŸŒŸ' : 'ğŸš§'}`;

      
      progressTrack.appendChild(progressFill);
      progressContainer.append(flagSpan, progressTrack, counterSpan);
      todolistContainer.appendChild(progressContainer);
    }
  });
</script>

<style>
   
  .todolist {
    padding-left: 0.6rem;
  }

  .todo-item {
    padding: 0.2rem;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    margin: -0.5rem 0 -0.5rem -0.7rem;
    line-height: 1.3;
  }

  .todo-item-checkbox {
    flex-shrink: 0;
    font-size: 1.2em;

    svg {
      margin-top: 0.46rem;
      width: 16px !important;
      height: 16px !important;
    }
  }

  .todo-item-checked-icon {
    fill: #707070;
  }

  .todo-item-unchecked-icon {
    fill: #1A61CC;
  }

  .todo-item-unchecked-icon:hover {
    fill: red;
    width: 20px !important;
    height: 20px !important;
  }

  .todo-item-content {
    flex: 1;
    word-break: break-all;

    p {
      margin: 0;
      padding: 0;
    }
  }

   
  .todo-progress {
    display: flex;
     
    align-items: center;
    gap: 0.3rem;
     
    margin: 0.1rem 0 0 0.7rem;
  }

  .todo-progress-counter {
     
    font-family: "LXGW WenKai";
    font-size: 0.8rem;
    color: #707070;
  }

  .todo-progress-bar {
    flex: 1;
    height: 2px;
    background: #a64036;
    border-radius: 10px;
    position: relative;
    overflow: hidden;
    max-width: 20%;
  }

  .todo-progress-bar-fill {
    height: 100%;
    background: #84a729;
    transition: width 0.3s ease;
  }

  .todo-progress-flag {
    display: none;
    position: relative;
    font-size: 0.9rem;
  }
</style>


  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/github.min.css">
<script src="https://cdn.jsdelivr.net/gh/captainwc/cdn-release/website/highlight/highlight.min.js"></script>
<script>document.addEventListener('DOMContentLoaded', () => hljs.highlightAll())</script>



  <script>
    const langToNerdFontMap = {
        asm: '\ue6ab',
        bash: '\ue760',
        bazel: '\ue63a',
        c: '\ue61e',
        cmake: '\ue794',
        cmd: '\uebc4',
        cpp: '\ue61d',
        'c++': '\ue61d',
        csharp: '\ue7b2',
        css: '\ue749',
        diff: '\ueae1',
        dockerfile: '\uf21f',
        go: '\udb81\udfd3',
        gradle: '\ue7f2',
        html: '\ue736',
        java: '\uedaf',
        javascript: '\ue781',
        json: '\ueb0f',
        latex: '\ue81f',
        llvm: '\ue823',
        lua: '\ue826',
        makefile: '\ue673',
        markdown: '\uf48a',
        maven: '\ue82c',
        plaintext: '\udb80\udd4d',
        plantuml: '\ue8cb',
        powershell: '\ue86c',
        python: '\ued1b',
        rust: '\udb85\ude17',
        shell: '\ue760',
        sql: '\udb82\udc66',
        text: '\udb80\udd4d',
        toml: '\ue6b2',
        txt: '\udb80\udd4d',
        typescript: '\ue8ca',
        uml: '\ue8cb',
        vim: '\ue7c5',
        wasm: '\ue8e0',
        xml: '\ue8ea',
        yaml: '\ue8eb',
    };

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('pre > code').forEach(codeBlock => {
            const parentElement = codeBlock.parentElement;

            
            const tools = document.createElement('div');
            tools.className = 'code-tools';

            
            const foldBtn = document.createElement('button');
            foldBtn.className = 'fold-btn';
            foldBtn.innerHTML = '\uf48c';
            foldBtn.style.display = 'none';

            
            const langLabel = document.createElement('div');
            langLabel.className = 'lang-label';
            const lang = [...codeBlock.classList].find(c => c.startsWith('language-'))?.split('-')[1] || 'text';
            const icon = langToNerdFontMap[lang.toLowerCase()];
            langLabel.textContent = icon || lang.toUpperCase();
            if (!icon) langLabel.style.fontSize = '0.8rem';

            
            const copyBtn = document.createElement('button');
            copyBtn.className = 'copy-btn';
            copyBtn.textContent = '\uf4bb COPY';

            
            const scale_height = 600;       
            const collapsed_height = 500;   
            const checkHeight = () => {
                const originalDisplay = parentElement.style.display;
                parentElement.style.display = 'block';
                const fullHeight = parentElement.scrollHeight;
                parentElement.style.display = originalDisplay;
                return fullHeight > scale_height;
            };

            
            if (checkHeight()) {
                foldBtn.style.display = 'flex';
                parentElement.dataset.fullHeight = `${parentElement.scrollHeight}px`;

                
                parentElement.classList.add('collapsed');
                parentElement.style.maxHeight = `${collapsed_height}px`;
                foldBtn.innerHTML = '\uf4d9';

                parentElement.style.overflowY = 'auto'; 

                foldBtn.addEventListener('click', () => {
                    const isCollapsed = parentElement.classList.toggle('collapsed');
                    foldBtn.innerHTML = isCollapsed ? '\uf4d9' : '\uf48c';

                    if (isCollapsed) {
                        parentElement.style.maxHeight = `${collapsed_height}px`;
                        parentElement.style.overflowX = 'auto';
                    } else {
                        parentElement.style.maxHeight = 'none';
                        void parentElement.offsetHeight;
                        parentElement.dataset.fullHeight = `${parentElement.scrollHeight}px`;
                    }
                });
            }

            
            copyBtn.addEventListener('click', async () => {
                try {
                    await navigator.clipboard.writeText(codeBlock.textContent);
                    copyBtn.textContent = '\uf00c COPIED!';
                    setTimeout(() => copyBtn.textContent = '\uf4bb COPY', 2000);
                } catch (err) {
                    console.error('å¤åˆ¶å¤±è´¥:', err);
                }
            });

            
            tools.append(langLabel, foldBtn, copyBtn);
            parentElement.prepend(tools);
        });
    });
</script>

<style>
 
.code-tools {
    position: absolute;
    right: 10px;
    top: 20px;
    display: flex;
    align-items: center;
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.2s ease;
    pointer-events: none;
    font-family: "Maple Mono NF CN";
}

.fold-btn {
    cursor: pointer;
    border: none;
    color: #666;
    background: none;
    font-family: "Maple Mono NF CN";
    font-size: 0.9rem;
    line-height: 1.2;
    margin: 0 0 0 0.45rem;
    transition: all 0.2s ease;
}

 
.lang-label {
     
    color: #666;
    font-size: 1.2rem;
    line-height: 1.2;
}

 
.copy-btn {
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 0 0.3rem;
    margin: 0 0 0 0.6rem;
    color: #333;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    font-size: 0.6rem;
    line-height: 1.8;
    cursor: pointer;
    font-family: "Maple Mono NF CN";
}

 
pre:hover .code-tools {
    opacity: 1;
    pointer-events: auto;
}
</style>


  
<script>
    
    window.diagramRenderUtils = {
        
        getOrCreateFullscreenOverlay: function() {
            let overlay = document.querySelector('.fullscreen-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.className = 'fullscreen-overlay';
                document.body.appendChild(overlay);

                
                overlay.addEventListener('dblclick', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });

                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && overlay.classList.contains('active')) {
                        overlay.classList.remove('active');
                    }
                });
            }
            return overlay;
        },

        
        createDiagramContainer: function() {
            const container = document.createElement('div');
            container.className = 'code-rendered-diagram';
            return container;
        },

        
        createCopyButton: function() {
            const copyButton = document.createElement('button');
            copyButton.className = 'code-rendered-diagram-copy-button';
            copyButton.innerHTML = '&#xf4bb; COPY-SRC';
            return copyButton;
        },

        
        createFullscreenButton: function() {
            const fullscreenButton = document.createElement('button');
            fullscreenButton.className = 'code-rendered-diagram-fullscreen-button';
            fullscreenButton.innerHTML = '&#xf065; FULL';
            return fullscreenButton;
        },

        
        makeSVGTransparent: function(svgText) {
            const doc = new DOMParser().parseFromString(svgText, 'image/svg+xml');
            doc.querySelectorAll('[fill="#ffffff"],[fill="white"],[style*="fill: white"]')
                .forEach(el => {
                    if (el.tagName !== 'svg') {
                        el.setAttribute('fill', 'transparent');
                    }
                });
            doc.documentElement.style.backgroundColor = 'transparent';
            return new XMLSerializer().serializeToString(doc);
        },

        
        setupCopyButton: function(copyButton, codeContent) {
            copyButton.addEventListener('click', async () => {
                try {
                    await navigator.clipboard.writeText(codeContent);
                    copyButton.textContent = '\uf00c COPIED!';
                    setTimeout(() => copyButton.innerHTML = '&#xf4bb; COPY-SRC', 2000);
                } catch (err) {
                    copyButton.textContent = 'FAILED';
                    console.error('å¤åˆ¶å¤±è´¥:', err);
                }
            });
        },

        
        setupShowSourceCode: function(imageElem, sourceCode) {
            
            imageElem.addEventListener('contextmenu', function(e) {
                e.preventDefault();

                
                const pre = document.createElement('pre');
                const codeElem = document.createElement('code');
                codeElem.textContent = sourceCode;
                pre.appendChild(codeElem);

                
                window.diagramRenderUtils.popupWindowUtils.create({
                    title: 'Source Code',
                    content: pre,
                    x: e.clientX,
                    y: e.clientY,
                    minWidth: 300,
                    maxWidth: '60%',
                    maxHeight: '60%',
                    closeOnClickOutside: true,
                    closeOnEsc: true,
                    className: 'source-code-viewer'
                });
            });
        },

        
        setupFullscreenButton: function(fullscreenButton, contentElement, isImage = false) {
            fullscreenButton.addEventListener('click', () => {
                const overlay = this.getOrCreateFullscreenOverlay();
                let clonedContent;

                if (isImage) {
                    
                    clonedContent = contentElement.cloneNode(true);
                } else {
                    
                    const svgElement = contentElement.querySelector('svg');
                    if (!svgElement) return;
                    clonedContent = svgElement.cloneNode(true);
                }

                overlay.innerHTML = '';

                
                const exitButton = document.createElement('button');
                exitButton.className = 'fullscreen-exit-button';
                exitButton.innerHTML = 'ESC';
                exitButton.onclick = () => overlay.classList.remove('active');

                overlay.appendChild(exitButton);
                overlay.appendChild(clonedContent);
                overlay.classList.add('active');

                
                this.setupZoomAndDrag(overlay, isImage ? 'img' : 'svg');
            });
        },

        
        setupZoomAndDrag: function(overlay, selector) {
            let scale = 1;
            let posX = 0;
            let posY = 0;
            let isDragging = false;
            let startX = 0;
            let startY = 0;

            const element = overlay.querySelector(selector);

            
            overlay.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY * -0.002;
                const newScale = Math.min(Math.max(scale + delta, 0.1), 10);

                
                const rect = element.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;

                
                posX += mouseX * (1 - newScale / scale);
                posY += mouseY * (1 - newScale / scale);

                scale = newScale;
                updateTransform();
            });

            
            overlay.addEventListener('mousedown', (e) => {
                if (e.target === overlay) return;
                isDragging = true;
                startX = e.clientX - posX;
                startY = e.clientY - posY;
                overlay.classList.add('dragging');
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                posX = e.clientX - startX;
                posY = e.clientY - startY;
                updateTransform();
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                overlay.classList.remove('dragging');
            });

            function updateTransform() {
                element.style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
            }
        },

        
        popupWindowUtils: {
            
            create: function(options) {
                
                const config = {
                    title: 'Popup Window',
                    content: '',         
                    x: 100,              
                    y: 100,              
                    minWidth: 300,       
                    maxWidth: '80%',     
                    maxHeight: '80%',    
                    closeOnClickOutside: true,
                    closeOnEsc: true,
                    onClose: null,       
                    className: ''        
                };

                
                Object.assign(config, options);

                
                if (config.className) {
                    const existingPopup = document.querySelector(`.popup-window.${config.className}`);
                    if (existingPopup) {
                        document.body.removeChild(existingPopup);
                    }
                }

                
                const popup = document.createElement('div');
                popup.className = `popup-window ${config.className}`.trim();

                
                const titleBar = document.createElement('div');
                titleBar.className = 'popup-window-title';
                titleBar.textContent = config.title;

                
                const closeButton = document.createElement('button');
                closeButton.className = 'popup-window-close';
                closeButton.innerHTML = '&times;';

                
                titleBar.appendChild(closeButton);

                
                const contentContainer = document.createElement('div');
                contentContainer.className = 'popup-window-content';

                
                if (typeof config.content === 'string') {
                    contentContainer.innerHTML = config.content;
                } else if (config.content instanceof Element) {
                    contentContainer.appendChild(config.content);
                }

                
                popup.appendChild(titleBar);
                popup.appendChild(contentContainer);

                
                popup.style.minWidth = typeof config.minWidth === 'number' ? `${config.minWidth}px` : config.minWidth;
                popup.style.maxWidth = typeof config.maxWidth === 'number' ? `${config.maxWidth}px` : config.maxWidth;
                popup.style.maxHeight = typeof config.maxHeight === 'number' ? `${config.maxHeight}px` : config.maxHeight;

                
                document.body.appendChild(popup);

                
                const popupRect = popup.getBoundingClientRect();
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;

                
                let left = Math.min(Math.max(config.x, 20), windowWidth - popupRect.width - 20);
                let top = Math.min(Math.max(config.y, 20), windowHeight - popupRect.height - 20);

                popup.style.left = `${left}px`;
                popup.style.top = `${top}px`;

                
                const closePopup = () => {
                    if (document.body.contains(popup)) {
                        document.body.removeChild(popup);
                        if (typeof config.onClose === 'function') {
                            config.onClose();
                        }
                    }
                };

                closeButton.addEventListener('click', closePopup);

                
                if (config.closeOnEsc) {
                    const escHandler = (e) => {
                        if (e.key === 'Escape' && document.body.contains(popup)) {
                            closePopup();
                            document.removeEventListener('keydown', escHandler);
                        }
                    };
                    document.addEventListener('keydown', escHandler);
                }

                
                if (config.closeOnClickOutside) {
                    const outsideClickHandler = (e) => {
                        if (popup && !popup.contains(e.target) && document.body.contains(popup)) {
                            closePopup();
                            document.removeEventListener('mousedown', outsideClickHandler);
                        }
                    };

                    
                    setTimeout(() => {
                        document.addEventListener('mousedown', outsideClickHandler);
                    }, 100);
                }

                
                let isDragging = false;
                let offsetX = 0;
                let offsetY = 0;

                titleBar.addEventListener('mousedown', (e) => {
                    
                    if (e.target !== closeButton) {
                        isDragging = true;
                        offsetX = e.clientX - popup.getBoundingClientRect().left;
                        offsetY = e.clientY - popup.getBoundingClientRect().top;
                        popup.classList.add('dragging');
                    }
                });

                const mouseMoveHandler = (e) => {
                    if (isDragging) {
                        let newLeft = e.clientX - offsetX;
                        let newTop = e.clientY - offsetY;

                        
                        newLeft = Math.max(0, Math.min(windowWidth - popupRect.width, newLeft));
                        newTop = Math.max(0, Math.min(windowHeight - popupRect.height, newTop));

                        popup.style.left = `${newLeft}px`;
                        popup.style.top = `${newTop}px`;
                    }
                };

                const mouseUpHandler = () => {
                    if (isDragging) {
                        isDragging = false;
                        popup.classList.remove('dragging');
                    }
                };

                document.addEventListener('mousemove', mouseMoveHandler);
                document.addEventListener('mouseup', mouseUpHandler);

                
                return {
                    element: popup,
                    contentElement: contentContainer,
                    close: closePopup,
                    setTitle: (title) => {
                        titleBar.textContent = title;
                        titleBar.appendChild(closeButton); 
                    },
                    setContent: (content) => {
                        contentContainer.innerHTML = '';
                        if (typeof content === 'string') {
                            contentContainer.innerHTML = content;
                        } else if (content instanceof Element) {
                            contentContainer.appendChild(content);
                        }
                    },
                    setPosition: (x, y) => {
                        let newLeft = Math.min(Math.max(x, 0), windowWidth - popupRect.width);
                        let newTop = Math.min(Math.max(y, 0), windowHeight - popupRect.height);
                        popup.style.left = `${newLeft}px`;
                        popup.style.top = `${newTop}px`;
                    },
                    
                    destroy: () => {
                        document.removeEventListener('mousemove', mouseMoveHandler);
                        document.removeEventListener('mouseup', mouseUpHandler);
                        if (document.body.contains(popup)) {
                            document.body.removeChild(popup);
                        }
                    }
                };
            }
        }
    };
</script>
<style>
     
    .code-rendered-diagram {
        max-width: 80% !important;
        height: auto;
        position: relative;

        svg {
            max-width: 100%;
            height: auto;
        }
    }

    .code-rendered-diagram-copy-button,
    .code-rendered-diagram-fullscreen-button {
        position: absolute;
        top: 20px;
        transform: translateY(-10px);
        transition: all 0.2s ease;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 0 0.3rem;
        margin: 0 0 0 0.6rem;
        color: #333;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        font-size: 0.6rem;
        line-height: 1.8;
        cursor: pointer;
        font-family: "Maple Mono NF CN";
        opacity: 0;
    }

    .code-rendered-diagram-copy-button {
        right: 10px;
    }

    .code-rendered-diagram-fullscreen-button {
        right: 100px;
    }

    .code-rendered-diagram:hover .code-rendered-diagram-copy-button,
    .code-rendered-diagram:hover .code-rendered-diagram-fullscreen-button {
        opacity: 1;
    }

    .fullscreen-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #FBFBFB;
         
        z-index: 99999;
        justify-content: center;
        align-items: center;
    }

    .fullscreen-overlay.active {
        display: flex;
    }

    .fullscreen-overlay img,
    .fullscreen-overlay svg {
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        cursor: move;
        transition: transform 0.1s ease-out;
        transform-origin: center center;
    }

    .fullscreen-overlay svg {
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
    }

    .fullscreen-overlay.dragging {
        cursor: move;
    }

    .fullscreen-exit-button {
        position: fixed;
        top: 20px;
        left: 20px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 6px;
        color: #666;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        font-size: 0.8rem;
        line-height: 1.8;
        cursor: pointer;
        font-family: "Maple Mono NF CN";
        transition: all 0.2s ease;
        z-index: 100000;
    }

    .fullscreen-exit-button:hover {
        background-color: #e0e0e0;
        color: #333;
    }

     
    .popup-window {
        position: fixed;
        z-index: 10000;
        background-color: #f8f8f8;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: box-shadow 0.3s ease;
    }

    .popup-window.dragging {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        opacity: 0.95;
    }

    .popup-window-title {
        background-color: #e8e8e8;
        padding: 8px 12px;
        font-weight: bold;
        border-bottom: 1px solid #ddd;
        cursor: move;
        user-select: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: #333;
        font-family: "Maple Mono NF CN", monospace;
        font-size: 0.9rem;
    }

    .popup-window-close {
        background: none;
        border: none;
        font-size: 1.2rem;
        line-height: 1;
        cursor: pointer;
        color: #666;
        padding: 0 4px;
        margin: -4px -4px 0 0;
        transition: color 0.2s ease;
    }

    .popup-window-close:hover {
        color: #333;
    }

    .popup-window-content {
        overflow: auto;
        padding: 10px;
        font-size: 0.9rem;
    }

     
    .popup-window.source-code-viewer .popup-window-content {
        font-family: "Maple Mono NF CN", monospace;
    }

    .popup-window.source-code-viewer .popup-window-content pre {
        margin: 0;
        white-space: pre-wrap;
    }

    .popup-window.source-code-viewer .popup-window-content code {
        font-family: "Maple Mono NF CN", monospace;
        color: #333;
    }
</style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const plantumlBlocks = document.querySelectorAll('pre code.language-plantuml');
        if (!plantumlBlocks.length) return;

        
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js';

        
        script.onload = () => {
            const plantuml_theme = parsePlantumlUserConfig();

            plantumlBlocks.forEach(codeBlock => {
                
                const container = window.diagramRenderUtils.createDiagramContainer();

                
                const img = document.createElement('img');
                img.className = 'code-rendered-diagram-img';
                img.style.display = 'block';
                img.alt = 'PlantUML Diagram';

                
                const fullCode = `${plantuml_theme}\n\n${codeBlock.textContent}`;
                img.src = 'https://www.plantuml.com/plantuml/svg/' + plantumlEncoder.encode(fullCode);

                
                const copyButton = window.diagramRenderUtils.createCopyButton();
                window.diagramRenderUtils.setupCopyButton(copyButton, fullCode);

                
                window.diagramRenderUtils.setupShowSourceCode(img, fullCode);

                
                const fullscreenButton = window.diagramRenderUtils.createFullscreenButton();
                window.diagramRenderUtils.setupFullscreenButton(fullscreenButton, img, true);

                
                

                
                container.appendChild(img);
                container.appendChild(fullscreenButton);
                container.appendChild(copyButton);
                codeBlock.parentElement.replaceWith(container);
            });
        };

        
        document.head.appendChild(script);
    });

    function parsePlantumlUserConfig() {
        let configItems = [];

        
            configItems.push(`scale 5`);
        

        
            configItems.push(`skin rose`);
        

        
            configItems.push(`skinparam BackgroundColor transparent`);
        

        
        
            
                configItems.push(`skinparam shadowing false`);
            
        

        

        
            configItems.push(`skinparam BackgroundColor transparent`);
        

        return configItems.join("\n").trim();
    }
</script>

  
<script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
        if (!mermaidBlocks.length) return;

        
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js';

        
        script.onload = () => {
            
            mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                fontFamily: 'Maple Mono NF CN',
                
                look: 'handDrawn',
                
                theme: 'neutral',
                
                
            });

            
            mermaidBlocks.forEach((codeBlock, index) => {
                
                const container = window.diagramRenderUtils.createDiagramContainer();

                
                const renderDiv = document.createElement('div');
                renderDiv.id = `mermaid-diagram-${index}`;
                renderDiv.style.background = 'transparent';

                
                const code = codeBlock.textContent.trim();

                try {
                    
                    mermaid.render(`mermaid-svg-${index}`, code).then(result => {
                        renderDiv.innerHTML = result.svg;

                        
                        const svg = renderDiv.querySelector('svg');
                        if (svg) {
                            svg.style.backgroundColor = 'transparent';
                            
                            svg.querySelectorAll('[fill="#ffffff"],[fill="white"],[style*="fill: white"]')
                                .forEach(el => {
                                    if (el.tagName !== 'svg') {
                                        el.setAttribute('fill', 'transparent');
                                    }
                                });
                        }
                    });
                } catch (error) {
                    console.error('Mermaidæ¸²æŸ“é”™è¯¯:', error);
                    renderDiv.innerHTML = `<div style="color:red;border:1px solid red;padding:10px;">
                        Mermaidæ¸²æŸ“é”™è¯¯: ${error.message}
                    </div>`;
                }

                
                const copyButton = window.diagramRenderUtils.createCopyButton();
                window.diagramRenderUtils.setupCopyButton(copyButton, code);

                
                window.diagramRenderUtils.setupShowSourceCode(renderDiv, code);

                
                const fullscreenButton = window.diagramRenderUtils.createFullscreenButton();
                window.diagramRenderUtils.setupFullscreenButton(fullscreenButton, renderDiv, false);

                
                container.appendChild(renderDiv);
                container.appendChild(fullscreenButton);
                container.appendChild(copyButton);

                
                const pre = codeBlock.closest('pre');
                pre.insertAdjacentElement('afterend', container);
                pre.remove();
            });
        };

        
        document.head.appendChild(script);
    });
</script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const markmapBlocks = document.querySelectorAll('pre code.language-map, pre code.language-mindmap');
        if (!markmapBlocks.length) return;

        
        function loadScript(url) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = url;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        
        Promise.all([
            loadScript('https://cdn.jsdelivr.net/npm/d3@latest'),
            loadScript('https://cdn.jsdelivr.net/npm/markmap-view@latest'),
            loadScript('https://cdn.jsdelivr.net/npm/markmap-lib@latest')
        ]).then(() => {
            
            markmapBlocks.forEach((codeBlock, index) => {
                
                const container = window.diagramRenderUtils.createDiagramContainer();

                
                const markmapContainer = document.createElement('div');
                markmapContainer.className = 'markmap';
                markmapContainer.id = `markmap-${index}`;
                markmapContainer.style.minHeight = '300px';
                markmapContainer.style.width = '100%';
                markmapContainer.style.position = 'relative';

                
                const code = codeBlock.textContent.trim();

                
                const svgElement = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svgElement.style.width = '100%';
                svgElement.style.height = '400px';
                markmapContainer.appendChild(svgElement);

                
                const copyButton = window.diagramRenderUtils.createCopyButton();
                window.diagramRenderUtils.setupCopyButton(copyButton, code);

                
                window.diagramRenderUtils.setupShowSourceCode(markmapContainer, code);

                
                const fullscreenButton = window.diagramRenderUtils.createFullscreenButton();
                window.diagramRenderUtils.setupFullscreenButton(fullscreenButton, markmapContainer, false);

                
                container.appendChild(markmapContainer);
                container.appendChild(fullscreenButton);
                container.appendChild(copyButton);

                
                const pre = codeBlock.closest('pre');
                pre.insertAdjacentElement('afterend', container);
                pre.remove();

                
                renderMarkmapWithRetry(svgElement, markmapContainer, code);
            });
        }).catch(error => {
            console.error('åŠ è½½markmapåº“å¤±è´¥:', error);
        });

        

        function renderMarkmapWithRetry(svgElement, markmapContainer, code, maxRetries = 5, delay = 200) {
            let attempt = 0;

            function tryRender() {
                attempt++;
                try {
                    
                    if (!window.markmap || typeof window.markmap.Markmap !== 'function') {
                        throw new Error('Markmap constructor not available yet.');
                    }

                    
                    const { Transformer } = window.markmap;
                    const transformer = new Transformer();

                    
                    const { root, features } = transformer.transform(code);

                    
                    const { Markmap } = window.markmap;
                    const mm = new Markmap(svgElement, {
                        autoFit: true,
                        duration: 500,
                        zoom: true,
                    });

                    
                    mm.setData(root, features);
                    mm.fit();

                    
                    markmapContainer.dataset.markmapData = JSON.stringify({
                        root: root,
                        features: features
                    });

                    
                    setTimeout(() => {
                        const links = svgElement.querySelectorAll('a');
                        links.forEach(link => {
                            link.setAttribute('target', '_blank');
                            link.setAttribute('rel', 'noopener noreferrer');
                        });
                    }, 100);

                } catch (error) {
                    console.error(`Markmapæ¸²æŸ“å°è¯•ç¬¬ ${attempt} æ¬¡å¤±è´¥:`, error.message);
                    if (attempt < maxRetries) {
                        
                        setTimeout(tryRender, delay);
                    } else {
                        
                        console.error('Markmapæ¸²æŸ“åœ¨å¤šæ¬¡é‡è¯•åä»ç„¶å¤±è´¥ã€‚');
                        markmapContainer.innerHTML = `<div style="color:red;border:1px solid red;padding:10px;">
                            Markmapæ¸²æŸ“é”™è¯¯: ${error.message} (è¯·å°è¯•æ‰‹åŠ¨åˆ·æ–°ç½‘é¡µ)
                        </div>`;
                    }
                }
            }

            
            tryRender();
        }
    });
</script>

<script>
    
    document.addEventListener('DOMContentLoaded', function() {
        
        if (!window.diagramRenderUtils) return;

        
        const originalSetupFullscreenButton = window.diagramRenderUtils.setupFullscreenButton;
        window.diagramRenderUtils.setupFullscreenButton = function(fullscreenButton, contentElement, isImage = false) {
            
            const isMarkmap = contentElement.classList.contains('markmap');

            if (isMarkmap) {
                fullscreenButton.addEventListener('click', () => {
                    const overlay = this.getOrCreateFullscreenOverlay();
                    overlay.innerHTML = '';

                    
                    const exitButton = document.createElement('button');
                    exitButton.className = 'fullscreen-exit-button';
                    exitButton.innerHTML = 'ESC';
                    exitButton.onclick = () => overlay.classList.remove('active');
                    overlay.appendChild(exitButton);

                    
                    const fullscreenContainer = document.createElement('div');
                    fullscreenContainer.className = 'markmap';
                    fullscreenContainer.style.width = '100%';
                    fullscreenContainer.style.height = '100%';

                    
                    const svgElement = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    svgElement.style.width = '100%';
                    svgElement.style.height = '100%';
                    fullscreenContainer.appendChild(svgElement);

                    overlay.appendChild(fullscreenContainer);
                    overlay.classList.add('active');

                    
                    try {
                        const markmapData = JSON.parse(contentElement.dataset.markmapData || '{}');
                        if (markmapData.root) {
                            
                            const { Markmap } = window.markmap;
                            const mm = new Markmap(svgElement, {
                                autoFit: true,
                                duration: 500,
                                zoom: true,
                            });

                            
                            mm.setData(markmapData.root, markmapData.features);
                            mm.fit();

                            
                            setTimeout(() => {
                                const links = svgElement.querySelectorAll('a');
                                links.forEach(link => {
                                    link.setAttribute('target', '_blank');
                                    link.setAttribute('rel', 'noopener noreferrer');
                                });
                            }, 100);
                        }
                    } catch (error) {
                        console.error('å…¨å±æ¨¡å¼ä¸‹æ¸²æŸ“markmapå¤±è´¥:', error);
                    }

                    
                    this.setupZoomAndDrag(overlay, 'svg');
                });
            } else {
                
                originalSetupFullscreenButton.call(this, fullscreenButton, contentElement, isImage);
            }
        };
    });
</script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const xmindBlocks = document.querySelectorAll('pre code.language-xmind');
        if (xmindBlocks.length === 0) {
            return;
        }

        
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/xmind-embed-viewer/dist/umd/xmind-embed-viewer.js';
        document.head.appendChild(script);

        
        script.onload = function() {
            xmindBlocks.forEach((codeBlock, index) => {
                const xmindUrl = codeBlock.textContent.trim();
                if (!xmindUrl) {
                    console.error('XMind code block is empty.');
                    return;
                }

                
                const mountId = `xmind-mount-${index}`;
                const mountDiv = document.createElement('div');
                mountDiv.id = mountId;

                
                const preElement = codeBlock.parentElement;
                preElement.parentElement.replaceChild(mountDiv, preElement);

                renderXmindFile(mountId, xmindUrl);
            });

            async function renderXmindFile(elementId, fileUrl) {
                const mountEl = document.getElementById(elementId);

                
                
                mountEl.className = 'xmind-container';
                
                mountEl.innerHTML = `
                <div class="xmind-loader-wrapper">
                    <div class="xmind-loader"></div>
                    <div class="xmind-loader-text">xmind loading</div>
                </div>
            `;

                try {
                    
                    const isExternal = fileUrl.startsWith('http');
                    const fetchUrl = isExternal ? `https://api.allorigins.win/raw?url=${encodeURIComponent(fileUrl)}` : fileUrl;
                    const res = await fetch(fetchUrl, {
                        mode: 'cors'
                    });

                    
                    if (!res.ok) {
                        mountEl.innerHTML = `
                        <div class="xmind-error">
                            <span class="xmind-error-icon">âš ï¸</span>
                            <div class="xmind-error-content">
                                <strong>åŠ è½½ XMind æ–‡ä»¶å¤±è´¥</strong>
                                <p>æ— æ³•ä» <code>${fileUrl}</code> è·å–æ–‡ä»¶ (HTTP ${res.status})</p>
                            </div>
                        </div>
                    `;
                        console.error(`Failed to fetch XMind file: ${res.statusText}`);
                        return;
                    }
                    const fileBuffer = await res.arrayBuffer();

                    
                    mountEl.className = ''; 
                    mountEl.innerHTML = ''; 

                    new XMindEmbedViewer({
                        el: `#${elementId}`,
                        file: fileBuffer,
                        styles: {
                            'height': '500px',
                            'width': '100%'
                        }
                    });
                } catch (error) {
                    
                    mountEl.innerHTML = `
                    <div class="xmind-error">
                        <span class="xmind-error-icon">âš ï¸</span>
                        <div class="xmind-error-content">
                            <strong>æ¸²æŸ“ XMind æ–‡ä»¶æ—¶å‡ºé”™</strong>
                            <p>${error.message}</p>
                        </div>
                    </div>
                `;
                    console.error('Error rendering XMind file:', error);
                }
            }
        }
    });
</script>

<style>
     
    .xmind-container {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 200px;
        background-color: #f9f9f9;
        border: 1px dashed #ddd;
        border-radius: 6px;
        margin: 1.5rem 0;
        padding: 20px;
    }

     
    .xmind-loader-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }

     
    .xmind-loader {
        border: 3px solid #f0f0f0;
        border-top: 3px solid #999;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
    }

     
    .xmind-loader-text {
        color: #888;
        font-size: 0.9rem;
        font-family: "LXGW WenKai", "Maple Mono NF CN", sans-serif;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

     
    .xmind-error {
        display: flex;
        align-items: flex-start;
        text-align: left;
        color: #c0392b;
        width: 100%;
    }

    .xmind-error-icon {
        font-size: 1.5rem;
        margin-right: 15px;
        line-height: 1.2;
    }

    .xmind-error-content {
        flex: 1;
    }

    .xmind-error strong {
        font-size: 1.1rem;
        color: #a93226;
    }

    .xmind-error p {
        margin: 5px 0 0;
        font-size: 0.9rem;
        color: #7b241c;
        word-break: break-all;
    }

    .xmind-error code {
        background-color: #fbeae5;
        padding: 2px 5px;
        border-radius: 4px;
        font-size: 0.85rem;
    }
</style>

  
<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        const DIAGRAM_MAP = new Map([
            ['plantuml_kroki', 'plantuml'],
            ['mermaid_kroki', 'mermaid'],
            ['graphviz', 'graphviz'],
            ['blockdiag', 'blockdiag'],
            ['seqdiag', 'seqdiag'],
            ['actdiag', 'actdiag'],
            ['packetdiag', 'packetdiag'],
            ['database', 'dbml'],
            ['dbml', 'dbml'],
            ['vega', 'vega']
        ]);

        
        const blocks = [];
        document.querySelectorAll('pre code[class]').forEach(block => {
            if (block.dataset.kroki) return;
            const lang = [...block.classList].find(c => DIAGRAM_MAP.has(c.split('-')[1]));
            if (lang) {
                block.dataset.kroki = 'processed';
                blocks.push({ block, api: DIAGRAM_MAP.get(lang.split('-')[1]) });
            }
        });

        if (!blocks.length) return;

        
        const CONCURRENCY = 6;
        const queue = blocks.slice();

        (async function processQueue() {
            const workers = Array(Math.min(CONCURRENCY, queue.length))
                .fill()
                .map(async () => {
                    while (queue.length) {
                        const { block, api } = queue.pop();
                        await renderBlock(block, api);
                    }
                });
            await Promise.all(workers);
        })();

        async function renderBlock(block, api) {
            const pre = block.closest('pre');
            try {
                const code = block.textContent.trim();
                if (!code) {
                    pre.style.border = '2px solid orange';
                    return;
                }

                const res = await fetch(`https://kroki.io/${api}/svg`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: code
                });

                if (!res.ok) throw new Error(`${await res.text()} (HTTP ${res.status})`);

                
                const svg = window.diagramRenderUtils.createDiagramContainer();
                svg.innerHTML = window.diagramRenderUtils.makeSVGTransparent(await res.text());

                
                const fullscreenButton = window.diagramRenderUtils.createFullscreenButton();
                window.diagramRenderUtils.setupFullscreenButton(fullscreenButton, svg, false);
                svg.appendChild(fullscreenButton);

                
                const copyButton = window.diagramRenderUtils.createCopyButton();
                window.diagramRenderUtils.setupCopyButton(copyButton, code);
                svg.appendChild(copyButton);

                
                window.diagramRenderUtils.setupShowSourceCode(svg, code);

                pre.insertAdjacentElement('afterend', svg);

                
                pre.remove();
            } catch (err) {
                console.error(`[Kroki] æ¸²æŸ“å¤±è´¥: ${err.message}`);
                pre.style.border = '2px solid red';
                pre.title = err.message;
            }
        }
    });
</script>


  <div id="search-modal">
  <input type="text" id="modal-search-input" placeholder="è¾“å…¥å…³é”®è¯æœç´¢..." aria-label="æœç´¢æ¡†" autocomplete="off">
  <div id="modal-search-debug" style="margin-bottom: 10px; color: #999;"></div>
  <div id="modal-search-results"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>

<script>
  function debug(text) {
      document.getElementById('modal-search-debug').textContent = text;
  }
  function showpages() {
    debug("å½“å‰æœ¬ç«™å…±æœ‰ " + searchIndex.length + " ç¯‡æ–‡ç« ");
  }

  let searchIndex = [];
  
  
    
  

  
    searchIndex.push({
      title: "\"é¢å‘æ¨¡å¼çš„è½¯ä»¶æ¶æ„ å·1 æ¨¡å¼ç³»ç»Ÿ è¯»ä¹¦ç¬”è®°\"",
      permalink: "\"/%E7%AC%94%E8%AE%B0/%E9%9D%A2%E5%90%91%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E5%8D%B71%E6%A8%A1%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/\"",
      
      categories: "[\"è¯»ä¹¦ç¬”è®°\",\"è½¯ä»¶å·¥ç¨‹\"]",
      tags: "[\"è®¾è®¡æ¨¡å¼\"]",
      series: "[\"è½¯ä»¶æ¶æ„ä¹‹é“\"]",
      date: "\"2025-12-04\""
    });
  
    searchIndex.push({
      title: "\"é“¾æ¥ç¬¦å·ä¸ç¬¦å·å¯¼å…¥å¯¼å‡ºå®â€”â€”è®°ä¸€æ¬¡å› clangdè¡¥å…¨å¤´æ–‡ä»¶äº§ç”Ÿçš„é“¾æ¥é”™è¯¯\"",
      permalink: "\"/cpp/%E9%93%BE%E6%8E%A5%E7%AC%A6%E5%8F%B7%E5%AF%BC%E5%87%BA%E4%B8%8E%E7%AC%A6%E5%8F%B7%E5%8F%AF%E8%A7%81%E5%AE%8F/\"",
      
      categories: "[\"C++ç¬”è®°\"]",
      tags: "[\"C++\"]",
      series: "[\"C++è¸©å‘\"]",
      date: "\"2025-11-17\""
    });
  
    searchIndex.push({
      title: "\"Qtä»é›¶å¼€å§‹ï¼ˆ0ï¼‰â€”â€”ç¯å¢ƒé…ç½®\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/qt%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: "[\"Qtä¸“æ \"]",
      date: "\"2025-08-30\""
    });
  
    searchIndex.push({
      title: "\"ubuntué…ç½®coredumpæ–‡ä»¶ç”Ÿæˆä½ç½®\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu%E7%94%9F%E6%88%90coredump%E6%96%87%E4%BB%B6/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: [],
      date: "\"2025-08-01\""
    });
  
    searchIndex.push({
      title: "\"ubuntuå®‰è£…ä¸­æ–‡è¾“å…¥æ³•ï¼ˆfcitx5-rimeï¼‰\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu%E5%AE%89%E8%A3%85rime%E8%BE%93%E5%85%A5%E6%B3%95/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: [],
      date: "\"2025-07-10\""
    });
  
    searchIndex.push({
      title: "\"SSHåå‘éš§é“ä¸­è½¬æœº-è¿œç¨‹è¿æ¥æœ¬åœ°æœåŠ¡å™¨\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/ssh%E5%8F%8D%E5%90%91%E9%9A%A7%E9%81%93%E4%B8%AD%E8%BD%AC%E6%9C%BA%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"ssh\"]",
      series: [],
      date: "\"2025-06-16\""
    });
  
    searchIndex.push({
      title: "\"C++ é«˜å¹¶å‘æœåŠ¡å™¨æ¨¡å‹å®ç° | [è½¬è½½](https://github.com/linkxzhou/mylib/blob/master/c%2B%2B/concurrency_server/README.md)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/06/10/22%E7%A7%8Dc-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"ç½‘ç»œç¼–ç¨‹\",\"C++\"]",
      series: [],
      date: "\"2025-06-10\""
    });
  
    searchIndex.push({
      title: "\"libclang-pyä½¿ç”¨ä»‹ç»\"",
      permalink: "\"/cpp/libclang-py%E4%BD%BF%E7%94%A8/\"",
      
      categories: [],
      tags: "[\"C++\",\"ç¼–è¯‘åŸç†\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2025-06-10\""
    });
  
    searchIndex.push({
      title: "\"å‚æ•°åŒ…ä¸æŠ˜å è¡¨è¾¾å¼å‚»å‚»åˆ†ä¸æ¸…\"",
      permalink: "\"/cpp/%E5%8F%82%E6%95%B0%E5%8C%85%E4%B8%8E%E6%8A%98%E5%8F%A0%E8%A1%A8%E8%BE%BE%E5%BC%8F/\"",
      
      categories: "[\"C++ç¬”è®°\"]",
      tags: "[\"C++\"]",
      series: "[\"modern c++\"]",
      date: "\"2025-06-05\""
    });
  
    searchIndex.push({
      title: "\"åç¨‹å¿«é€Ÿå…¥é—¨\"",
      permalink: "\"/cpp/%E5%8D%8F%E7%A8%8B%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/\"",
      
      categories: "[\"C++ç¬”è®°\"]",
      tags: "[\"coroutine\",\"C++\"]",
      series: "[\"modern c++\"]",
      date: "\"2025-05-21\""
    });
  
    searchIndex.push({
      title: "\"åˆç­‰æ•°å­¦å›å¿†å½•\"",
      permalink: "\"/%E7%AC%94%E8%AE%B0/%E5%88%9D%E7%AD%89%E6%95%B0%E5%AD%A6%E5%9B%9E%E5%BF%86%E5%BD%95/\"",
      
      categories: "[\"æ•°å­¦\"]",
      tags: "[\"æ•°å­¦\",\"ä¸‰è§’å‡½æ•°\",\"æåæ ‡\",\"å®šç§¯åˆ†\"]",
      series: [],
      date: "\"2025-05-16\""
    });
  
    searchIndex.push({
      title: "\"Epollè¯¦ç»†ä»‹ç» | [è½¬è½½](https://mp.weixin.qq.com/s/pahk8ay5MvkvONeg1-M82w)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/05/04/epoll%E8%AF%A6%E8%A7%A3/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"ç½‘ç»œç¼–ç¨‹\",\"epoll\"]",
      series: [],
      date: "\"2025-05-04\""
    });
  
    searchIndex.push({
      title: "\"å…±äº«å†…å­˜è¯¦è§£ | [è½¬è½½](https://mp.weixin.qq.com/s/wOySn0oi0xXREpFRBXCMmQ)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/05/04/%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"ç½‘ç»œç¼–ç¨‹\"]",
      series: [],
      date: "\"2025-05-04\""
    });
  
    searchIndex.push({
      title: "\"Asio åŸºæœ¬ä½¿ç”¨ä¸æ ¸å¿ƒè®¾è®¡æ€æƒ³ | [è½¬è½½](https://blog.csdn.net/gma999/article/details/143983035)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/04/17/asio-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E4%B8%8E%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"asio\"]",
      series: "[\"ç½‘ç»œç¼–ç¨‹\"]",
      date: "\"2025-04-17\""
    });
  
    searchIndex.push({
      title: "\"GoogleTestä¸gMockè¿›é˜¶æŒ‡å— | [è½¬è½½](https://www.cnblogs.com/jinyunshaobing/p/16804309.html)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/04/16/googletest%E4%B8%8Egmock%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"GoogleTest\"]",
      series: [],
      date: "\"2025-04-16\""
    });
  
    searchIndex.push({
      title: "\"GTest / GMock å•å…ƒæµ‹è¯•å®è·µæ‰‹å†Œ | [è½¬è½½](https://imageslr.com/2023/gtest.html)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/04/16/gtest_gmock-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"GoogleTest\"]",
      series: [],
      date: "\"2025-04-16\""
    });
  
    searchIndex.push({
      title: "\"Docker ç½‘ç»œæ¨¡å¼è¯¦è§£åŠå®¹å™¨é—´ç½‘ç»œé€šä¿¡ | [è½¬è½½](https://www.cnblogs.com/mrhelloworld/p/docker11.html)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/04/15/docker-%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3%E5%8F%8A%E5%AE%B9%E5%99%A8%E9%97%B4%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"Docker\"]",
      series: [],
      date: "\"2025-04-15\""
    });
  
    searchIndex.push({
      title: "\"ä¸‡å­—é•¿æ–‡ç®€è¿°Apolloä¸­CyberRTæ¡†æ¶åŸºç¡€æ¦‚å¿µ | [è½¬è½½](https://zhuanlan.zhihu.com/p/479518561#CTZ_DEFAULT)\"",
      permalink: "\"/%E8%BD%AC%E8%BD%BD/2025/04/15/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AE%80%E8%BF%B0apollo%E4%B8%ADcyberrt%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/\"",
      
      categories: "[\"åšå®¢å‰ªè—\"]",
      tags: "[\"CyberRT\"]",
      series: [],
      date: "\"2025-04-15\""
    });
  
    searchIndex.push({
      title: "\"C++å°æŠ€å·§\"",
      permalink: "\"/cpp/c++%E5%B0%8F%E6%8A%80%E5%B7%A7/\"",
      
      categories: "[\"C++ç¬”è®°\"]",
      tags: "[\"C++\"]",
      series: "[\"modern c++\"]",
      date: "\"2025-04-14\""
    });
  
    searchIndex.push({
      title: "\"tmux å¿«é€Ÿä¸Šæ‰‹\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/tmux%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"tmux\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2025-04-08\""
    });
  
    searchIndex.push({
      title: "\"Valgrindå¿«é€Ÿä¸Šæ‰‹\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/valgrind%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"valgrind\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2025-04-08\""
    });
  
    searchIndex.push({
      title: "\"Mermaidå¿«é€Ÿä¸Šæ‰‹\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/mermaid%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"mermaid\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2025-04-07\""
    });
  
    searchIndex.push({
      title: "\"CyberRTæ¡†æ¶æ€»è§ˆ\"",
      permalink: "\"/%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6/cyberrt/cyberrt%E6%A1%86%E6%9E%B6%E6%80%BB%E8%A7%88/\"",
      
      categories: "[\"è‡ªåŠ¨é©¾é©¶\"]",
      tags: "[\"CyberRT\"]",
      series: "[\"CyberRTä¸“é¡¹æ€»ç»“\"]",
      date: "\"2025-04-02\""
    });
  
    searchIndex.push({
      title: "\"é€šä¿¡ä¸­é—´ä»¶æœ¯è¯­è¡¨\"",
      permalink: "\"/%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6/cyberrt/%E6%9C%AF%E8%AF%AD%E8%A1%A8/\"",
      
      categories: "[\"è‡ªåŠ¨é©¾é©¶\"]",
      tags: [],
      series: "[\"CyberRTä¸“é¡¹æ€»ç»“\"]",
      date: "\"2025-03-27\""
    });
  
    searchIndex.push({
      title: "\"ç°ä»£C++å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/c++%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: "[\"c++\"]",
      series: [],
      date: "\"2025-03-26\""
    });
  
    searchIndex.push({
      title: "\"å¸¦ç€ç›®çš„å­¦ï¼šCyberRT\"",
      permalink: "\"/%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6/cyberrt/%E5%B8%A6%E7%9D%80%E9%97%AE%E9%A2%98%E5%AD%A6cyberrt/\"",
      
      categories: "[\"è‡ªåŠ¨é©¾é©¶\"]",
      tags: "[\"CyberRT\"]",
      series: "[\"CyberRTä¸“é¡¹æ€»ç»“\"]",
      date: "\"2025-03-25\""
    });
  
    searchIndex.push({
      title: "\"Linuxç¯å¢ƒå˜é‡åŠ è½½é¡ºåºåˆ†æ\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/linux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%8A%A0%E8%BD%BD%E9%A1%BA%E5%BA%8F%E5%88%86%E6%9E%90/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: "[\"linux\"]",
      series: [],
      date: "\"2025-03-14\""
    });
  
    searchIndex.push({
      title: "\"æ‰‹å†Œé€ŸæŸ¥æ–¹æ¡ˆï¼ˆå¦‚cppreferenceï¼‰\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/zeal-dataset%E4%B8%AD%E6%96%87cppreference%E9%85%8D%E7%BD%AE/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: "[\"cppreference\"]",
      series: [],
      date: "\"2025-03-12\""
    });
  
    searchIndex.push({
      title: "\"CyberRTä¸­çš„ä»£ç å’Œå·¥ç¨‹æŠ€å·§\"",
      permalink: "\"/%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6/cyberrt/cyberrt%E4%B8%AD%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%92%8C%E4%BB%A3%E7%A0%81%E6%8A%80%E5%B7%A7/\"",
      
      categories: "[\"è‡ªåŠ¨é©¾é©¶\"]",
      tags: "[\"CyberRT\",\"C++\"]",
      series: "[\"CyberRTä¸“é¡¹æ€»ç»“\"]",
      date: "\"2025-03-01\""
    });
  
    searchIndex.push({
      title: "\"è®¾è®¡æ¨¡å¼\"",
      permalink: "\"/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/\"",
      
      categories: "[\"è½¯ä»¶å·¥ç¨‹\"]",
      tags: "[\"SE\"]",
      series: "[\"è®¾è®¡æ¨¡å¼ä¸“é¡¹æ€»ç»“\"]",
      date: "\"2025-02-28\""
    });
  
    searchIndex.push({
      title: "\"ä¸€ç«™å¼ç¯å¢ƒé…ç½®\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E4%B8%80%E7%AB%99%E5%BC%8F%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: [],
      date: "\"2025-02-24\""
    });
  
    searchIndex.push({
      title: "\"leetcodeè°ƒè¯•æŒ‡å—\"",
      permalink: "\"/%E7%AE%97%E6%B3%95/leetcode%E8%B0%83%E8%AF%95%E6%8C%87%E5%8D%97/\"",
      
      categories: [],
      tags: "[\"leetcode\"]",
      series: [],
      date: "\"2024-03-14\""
    });
  
    searchIndex.push({
      title: "\"linuxå‘½ä»¤è¡Œå¤§è®°å¿†æ¢å¤æœ¯\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"linux\",\"cmdline\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2023-11-25\""
    });
  
    searchIndex.push({
      title: "\"ç•ªèŒ„é¸¡è›‹é¢\"",
      permalink: "\"/%E8%A1%A3%E9%A3%9F%E4%BD%8F%E8%A1%8C/%E8%8F%9C%E8%B0%B1/%E7%95%AA%E8%8C%84%E9%B8%A1%E8%9B%8B%E9%9D%A2/\"",
      
      categories: "[\"è¡£é£Ÿä½è¡Œ\"]",
      tags: [],
      series: "[\"å¿«é€Ÿåšé¥­\"]",
      date: "\"2023-10-22\""
    });
  
    searchIndex.push({
      title: "\"PlantUMLå¿«é€Ÿä¸Šæ‰‹\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/plantuml%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"uml\",\"plantuml\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2023-10-11\""
    });
  
    searchIndex.push({
      title: "\"WSLå®‰è£…ä¸é…ç½®\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/wsl%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: [],
      date: "\"2023-09-12\""
    });
  
    searchIndex.push({
      title: "\"C++ç½‘ç»œç¼–ç¨‹å…¥é—¨æ¦‚å¿µåŠapiæ€»ç»“\"",
      permalink: "\"/%E7%AC%94%E8%AE%B0/linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/\"",
      
      categories: [],
      tags: "[\"linux\",\"ç½‘ç»œç¼–ç¨‹\"]",
      series: "[\"é¢ç­‹\",\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2023-04-02\""
    });
  
    searchIndex.push({
      title: "\"è‹å·æ—…è¡Œè®¡åˆ’\"",
      permalink: "\"/%E8%A1%A3%E9%A3%9F%E4%BD%8F%E8%A1%8C/%E6%97%85%E8%A1%8C%E6%94%BB%E7%95%A5/%E8%8B%8F%E5%B7%9E/\"",
      
      categories: "[\"è¡£é£Ÿä½è¡Œ\"]",
      tags: "[\"æ—…è¡Œ\"]",
      series: [],
      date: "\"2023-04-01\""
    });
  
    searchIndex.push({
      title: "\"gdbå¿«é€Ÿä¸Šæ‰‹\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/gdb%E6%95%99%E7%A8%8B/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"gdb\",\"cmdline\"]",
      series: "[\"å¿«é€Ÿä¸Šæ‰‹\"]",
      date: "\"2022-11-25\""
    });
  
    searchIndex.push({
      title: "\"Ubuntu22.04å®‰è£…Hadoopå®Œå…¨åˆ†å¸ƒå¼é›†ç¾¤\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu%E9%85%8D%E7%BD%AEhadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: "[\"hadoop\"]",
      series: [],
      date: "\"2022-11-21\""
    });
  
    searchIndex.push({
      title: "\"C++è¿æ¥mysql\"",
      permalink: "\"/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/c++%E8%BF%9E%E6%8E%A5mysql/\"",
      
      categories: "[\"ç¯å¢ƒé…ç½®\"]",
      tags: [],
      series: [],
      date: "\"2022-11-20\""
    });
  
    searchIndex.push({
      title: "\"å¾æœCæŒ‡é’ˆç¬”è®°\"",
      permalink: "\"/%E7%AC%94%E8%AE%B0/%E5%BE%81%E6%9C%8Dc%E6%8C%87%E9%92%88/\"",
      
      categories: [],
      tags: [],
      series: [],
      date: "\"2022-10-04\""
    });
  
    searchIndex.push({
      title: "\"Leetcodeåˆ·é¢˜æŒ‡å—\"",
      permalink: "\"/%E7%AE%97%E6%B3%95/leetcode%E5%88%B7%E9%A2%98%E6%8C%87%E5%8D%97/\"",
      
      categories: "[\"ç®—æ³•\"]",
      tags: "[\"leetcode\"]",
      series: "[\"leetcodeåˆ·é¢˜æŒ‡å—\"]",
      date: "\"2022-09-11\""
    });
  
    searchIndex.push({
      title: "\"word é¡µçœ‰é¡µè„šè®¾ç½®\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/word%E9%A1%B5%E7%9C%89%E9%A1%B5%E8%84%9A%E9%85%8D%E7%BD%AE/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: [],
      series: [],
      date: "\"2021-04-03\""
    });
  
    searchIndex.push({
      title: "\"Markdown Demo\"",
      permalink: "\"/%E6%B5%8B%E8%AF%95/markdown-demo/\"",
      
      categories: [],
      tags: "[\"markdown\"]",
      series: [],
      date: "\"2021-02-15\""
    });
  
    searchIndex.push({
      title: "\"å¸¸ç”¨æ•°å­¦ç¬¦å·çš„latexè¡¨ç¤º\"",
      permalink: "\"/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8%E6%95%B0%E5%AD%A6%E7%AC%A6%E5%8F%B7%E7%9A%84latex%E8%A1%A8%E7%A4%BA/\"",
      
      categories: "[\"å·¥å…·ä½¿ç”¨\"]",
      tags: "[\"latex\",\"markdown\"]",
      series: [],
      date: "\"2021-02-15\""
    });
  

  showpages()

  const options = {
    includeScore: true,
    threshold: 0.6,
    keys: [
      { name: 'title', weight: 0.7 },
      { name: 'content', weight: 0.3 },
      { name: 'tags', weight: 0.5 },
      { name: 'categories', weight: 0.5 },
      { name: 'series', weight: 0.5 }
    ]
  };

  const fuse = new Fuse(searchIndex, options);

  document.addEventListener('keydown', function(event) {
    if (event.ctrlKey && event.key === 'k') {
      event.preventDefault();
      toggleSearchModal();
    } else if (event.key === 'Escape') {
      document.getElementById('modal-search-input').value = "";
      closeSearchModal();
      var res = document.getElementById('modal-search-results');
      while (res.firstChild) {
        res.removeChild(res.firstChild);
      }
      showpages();
    }
  });

  function toggleSearchModal() {
    const modal = document.getElementById('search-modal');
    if (modal.style.display === 'none') {
      modal.style.display = 'block';
      document.getElementById('modal-search-input').focus();
    } else {
      modal.style.display = 'none';
    }
  }

  function closeSearchModal() {
    const modal = document.getElementById('search-modal');
    modal.style.display = 'none';
  }

  document.getElementById('modal-search-input').addEventListener('input', function(e) {
    const searchTerm = e.target.value.trim();
    const resultsContainer = document.getElementById('modal-search-results');
    resultsContainer.innerHTML = '';

    if (searchTerm === '') {
      showpages()
      return;
    }

    const results = fuse.search(searchTerm);

    results.sort((a, b) => new Date(b.item.date) - new Date(a.item.date));

    if (results.length === 0) {
      showpages()
      resultsContainer.innerHTML = '<p>æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–‡ç« </p>';
      return;
    } else {
      debug("å…±æ‰¾åˆ° " + results.length + " ç¯‡åŒ¹é…çš„æ–‡ç« ")
    }

    results.forEach(result => {
      const item = result.item;
      const resultItem = document.createElement('div');
      resultItem.className = 'modal-search-result-item';

      const date = document.createElement('span');
      date.textContent = item.date.replace(/^"|"$/g, '') + '   ';
      date.className = 'modal-search-result-date';

      const link = document.createElement('a');
      link.href = item.permalink.replace(/^"|"$/g, '');
      link.textContent = item.title.replace(/^"|"$/g, '');
      link.className = 'modal-search-result-title';

      resultItem.appendChild(date);
      resultItem.appendChild(link);
      resultsContainer.appendChild(resultItem);
    });
  });
</script>

<style>
 
#search-modal {
    display: none;
    position: fixed;
    top: 6%;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    padding: 20px;
    box-shadow: 0 0 6px rgba(45, 45, 45, 0.5);
    border-radius: 6px;
    z-index: 1000;
    width: 80%;
    max-width: 600px;
    text-align: left;
}

#modal-search-input {
    width: 100%;
    padding: 10px;
    box-sizing: border-box;
    font-size: 1rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 1rem;
}

#modal-search-results {
    margin-top: 10px;
    max-height: 60vh;
    overflow-y: auto;
}

.modal-search-result-item {
    padding: 0.7rem;
    margin-bottom: 0.5rem;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: center;
}

.modal-search-result-date {
    color: #666;
    font-size: 1.1rem;
    margin-right: 0.5rem;
    text-wrap: nowrap;
}

.modal-search-result-title {
    font-weight: bold;
    color: #1a73e8;
    text-decoration: none;
}

.modal-search-result-title:hover {
    text-decoration: underline;
}
</style>


  

  
  <hr />
  Â© 
<a href="https://kaikaixixi.xyz"  target="_blank" rel="noopener noreferrer" >SHUAIKAI</a>
 2021 &ndash; 2025 | ğŸ¨
<a href="https://github.com/captainwc/ksimple"  target="_blank" rel="noopener noreferrer" >KSimple</a>
  

</footer>
</body>

</html>
